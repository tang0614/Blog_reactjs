!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Af){"use strict";try{(function(){Af=Af&&Object.prototype.hasOwnProperty.call(Af,"default")?Af.default:Af;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(n(w,v=Error),w);function w(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={},S=R||self;function _(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++V))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var K=S.navigator;if(K){var J=K.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function it(t){return it[" "](t),t}it[" "]=_;var rt,ot,st=X(H,"Opera"),ut=X(H,"Trident")||X(H,"MSIE"),at=X(H,"Edge"),ht=at||ut,ct=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),lt=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function ft(){var t=S.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=H,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):lt?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=ft();if(null!=yt&&yt>parseFloat(pt)){rt=String(yt);break t}}rt=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=S.document&&ut?ft()||(parseInt(rt,10)||void 0):void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",_,e),S.removeEventListener("test",_,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{it(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},j(At,It);var Tt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function kt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++Rt,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=B(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Lt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}_t.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Bt(i);return e&&e[Nt]?e.wa(n,i,D(r)?!!r.capture:!!r,o):Ct(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=Bt(n),t&&t[Nt]?t.va(e,n,D(i)?!!i.capture:!!i,r):Ct(t,e,n,!1,i,r)}function Ct(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=D(r)?!!r.capture:!!r;if(s&&!wt)return null;var u,a,h=jt(t);if(h||(t[Dt]=h=new _t(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=xt,i=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Et||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ut(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?Ot(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Mt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=jt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Dt]=null)):St(t)))}function Mt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function qt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Ut(t),n.call(i,e)}function xt(t,e){if(t.Y)return!0;if(wt)return qt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=S,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return qt(t,e=new At(e,this))}function jt(t){return(t=t[Dt])instanceof _t?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==O(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new _t(this),(this.J=this).C=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}j(Gt,F),Gt.prototype[Nt]=!0,(N=Gt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=D(r)?!!r.capture:!!r,i=Bt(i),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Lt(s=e.a[n],i,r,o))&&(St(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ut(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=zt(o,i,!0,t)&&s;if(s=zt(o=t.a=n,i,!0,t)&&s,s=zt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=zt(o=t.a=e[r],i,!1,t)&&s;return s},N.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)St(n[i]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var $t=S.JSON.stringify;function Wt(){this.b=this.a=null}var Ht,Qt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Yt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Kt(t,e){var n;Ht||(n=S.Promise.resolve(void 0),Ht=function(){n.then(te)}),Jt||(Ht(),Jt=!0),Zt.add(t,e)}Wt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Wt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var i=Qt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Jt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Ya,this),this.g=x()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==O(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(ee,Gt),(N=ee.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){ee.S.G.call(this),ne(this),delete this.a};var re,oe,se,ue=(A(oe=he,se=re=F),oe.prototype=null===se?Object.create(se):(ae.prototype=se.prototype,new ae),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){re.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ae(){this.constructor=oe}function he(t,e,n){var i=re.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function ce(t){F.call(this),this.b=t,this.a={}}j(ce,F);var le=[];function fe(t,e,n,i){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return $t(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Gt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Ae(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(me,It),j(be,It),j(Ie,It);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Re(){}function ke(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}Re.prototype.a=null;var _e,Oe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Le(){It.call(this,"d")}function De(){It.call(this,"c")}function Pe(){}function Ve(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new ce(this),this.P=Ce,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Le,It),j(De,It),j(Pe,Re),_e=new Pe;var Ce=45e3,Ue={},Me={};function qe(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=x(),Fe(t),t.l=Ze(t.i);var s,u,a,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),wn(n.b,"t",i),t.D=0,t.a=fi(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(M(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var i,r,o,s,u=!0;!t.A&&t.D<n.length;){var a=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?Me:(o=Number(r.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>r.length?Me:(r=r.substr(s,o),i.D=s+o,r)));if(a==Me){4==e&&(t.h=4,Ee(14),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ue){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),We(t,a)}4==e&&0==n.length&&(t.h=1,Ee(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ri(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),$e(t),ze(t))}function Fe(t){t.U=x()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ae(M(t.Ua,t),e)}function Ge(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ui(t.g,t)}function $e(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n,i,r,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Rn(p.b,t)))if(p.I=t.N,!t.C&&Rn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;si(p),Xn(p)}ii(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ae(M(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hi(p,11)}else if(!t.C&&p.a!=t||si(p),!W(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(X(u,"spdy")||X(u,"quic")||X(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(kn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=x()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=li(o,o.C?o.ga:null,o.fa),c.C?(Sn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Ge(l),Fe(l)),o.a=c):ni(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||hi(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hi(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ye(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Ye(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Ve.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),i=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||i<=0?3:2),Ge(this);var r=this.a.X();this.N=r;var o=this.a.$();if(this.b=200==r,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,y=r,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ee(12),$e(this),ze(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,a)}this.I?(je(this,e,o),ht&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),We(this,o)),4==e&&$e(this),this.b&&!this.A&&(4==e?ui(this.g,this):(this.b=!1,Fe(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),$e(this),ze(this)}}}catch(t){}var h,c,l,f,p,d,y},N.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),je(this,t,e),this.b&&4!=t&&Fe(this)))},N.cancel=function(){this.A=!0,$e(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),$e(this),this.h=2,ze(this)):Be(this,this.U-n)},(N=Qe.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Xe(this),this.a.concat()},N.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},N.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function Ze(t){return new Je(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var i,r;e instanceof yn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(vn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},i)),i.f=r):(n||(e=an(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?fn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,dn)),t.join("")};var cn=/[#\/\?@]/g,ln=/[#\?:]/g,fn=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i,r=t[n].indexOf("="),o=null;0<=r?(i=t[n].substring(0,r),o=t[n].substring(r+1)):i=t[n],e(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function mn(t,e){return vn(t),e=bn(t,e),Ye(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),$(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||An,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){vn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},N.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var An=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function Rn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function kn(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return $(t.c);var i=t.c;try{for(var r=T(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function On(){}function Ln(){this.a=new On}function Dn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Pn=S.JSON.parse;function Vn(t){Gt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}j(Vn,Gt);var Cn="",Un=/^https?$/i,Mn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Bn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(r=(i=S.self.location.protocol).substr(0,i.length-1)),n=!Un.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Gn(t);var n=t.a,i=t.s[0]?_:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function $n(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",Z(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Wn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Wn("baseRetryDelayMs",5e3,t),this.Ma=Wn("retryDelaySeedMs",1e4,t),this.Ja=Wn("forwardChannelMaxRetries",2,t),this.ma=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new Ln,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,on(n=Ze(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),ti(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=fi(e.g,null),e.a.ba(e.i)),e.u=x(),Fe(e)),ci(t)}function Xn(t){t.a&&(ri(t),t.a.cancel(),t.a=null)}function Yn(t){Xn(t),t.j&&(S.clearTimeout(t.j),t.j=null),si(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Tn(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,i=Ze(t.B);on(i,"SID",t.J),on(i,"RID",n),on(i,"AID",t.P),ti(t,i),t.i&&t.l&&$n(i,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ei(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),kn(t.b,n),qe(n,i,e)}function ti(t,n){t.f&&He({},function(t,e){on(n,e,t)})}function ei(t,e,n){n=Math.min(t.g.length,n);var i=t.f?M(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i,e){var r=e||"";try{He(t,function(t,e){var n=t;D(t)&&(n=$t(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ni(t){t.a||t.j||(t.U=1,Kt(t.Aa,t),t.o=0)}function ii(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ae(M(t.Aa,t),ai(t,t.o)),t.o++,1)}function ri(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function oi(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),ti(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&$n(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,xe(n,t)}function si(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ui(t,e){var n,i=null;if(t.a==e){si(t),ri(t),t.a=null;var r=2}else{if(!Rn(t.b,e))return;i=e.s,Sn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b){1==r?(i=e.j?e.j.length:0,e=x()-e.u,n=t.u,(r=ge()).dispatchEvent(new Ie(r)),Jn(t)):ni(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ae(M(t.Ba,t,e),ai(t,t.u)),t.u++,1}}(t,e)||2==r&&ii(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:hi(t,5);break;case 4:hi(t,10);break;case 3:hi(t,6);break;default:hi(t,2)}}function ai(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hi(t,e){var n,i,r,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=M(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||tn(n,"https"),sn(n)),r=n.toString(),o=i,u=new de,S.Image?((s=new Image).onload=q(Dn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=q(Dn,u,s,"TestLoadImage: error",!1,o),s.onabort=q(Dn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=q(Dn,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),ci(t),Yn(t)}function ci(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,$(t.g),t.g.length=0),t.f.qa())}function li(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Je?Ze(i):new Je(i,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(r=S.location,o=r.protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Je(null,void 0),o&&tn(h,o),s&&en(h,s),u&&nn(h,u),a&&(h.g=a),c=h),t.W&&Z(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),ti(t,c),c}function fi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function pi(){}function di(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yi(t,e){Gt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mi(this)}function vi(t){Le.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gi(){De.call(this),this.status=1}function mi(t){this.a=t}(N=Vn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ke(this.H):ke(_e),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&He(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=qn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Mn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(r=this.a,ut&&gt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},N.xa=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Vn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Fn(this):this.Ta())},N.Ta=function(){Fn(this)},N.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Hn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),i=this.l;if(this.O&&(i?nt(i=tt(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ei(this,n,e),on(r=Ze(this.B),"RID",t),on(r,"CVER",22),this.A&&on(r,"X-HTTP-Session-Id",this.A),ti(this,r),this.i&&i&&$n(r,this.i,i),kn(this.b,n),this.Ga&&on(r,"TYPE","init"),this.da?(on(r,"$req",e),on(r,"SID","null"),n.V=!0,qe(n,r,null)):qe(n,r,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||Tn(this.b)||Zn(this))},N.Aa=function(){var t;this.j=null,oi(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ae(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),oi(this))},N.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ii(this),Ee(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(N=pi.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},di.prototype.a=function(t,e){return new yi(t,e)},j(yi,Gt),(N=yi.prototype).addEventListener=function(t,e,n,i){yi.S.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){yi.S.removeEventListener.call(this,t,e,n,i)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=li(t,null,t.fa),Jn(t)},N.close=function(){Qn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=$t(t),Kn(this.a,e)):Kn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,yi.S.G.call(this)},j(vi,Le),j(gi,De),j(mi,pi),mi.prototype.ta=function(){this.a.dispatchEvent("a")},mi.prototype.sa=function(t){this.a.dispatchEvent(new vi(t))},mi.prototype.ra=function(t){this.a.dispatchEvent(new gi)},mi.prototype.qa=function(){this.a.dispatchEvent("b")},di.prototype.createWebChannel=di.prototype.a,yi.prototype.send=yi.prototype.Pa,yi.prototype.open=yi.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(Se.EventType=Oe).OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var wi={createWebChannelTransport:function(){return new di},ErrorCode:Te,EventType:Ne,WebChannel:Se,XhrIo:Vn},bi=wi.createWebChannelTransport,Ei=wi.ErrorCode,Ii=wi.EventType,Ai=wi.WebChannel,Ti=wi.XhrIo,Ni=(Ri.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ri.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ri.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ri);function Ri(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var ki=new l("@firebase/firestore");function Si(){return ki.logLevel}function _i(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];ki.logLevel<=u.DEBUG&&(e=n.map(Di),ki.debug.apply(ki,r(["Firestore (7.19.0): "+t],e)))}function Oi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];ki.logLevel<=u.ERROR&&(e=n.map(Di),ki.error.apply(ki,r(["Firestore (7.19.0): "+t],e)))}function Li(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];ki.logLevel<=u.WARN&&(e=n.map(Di),ki.warn.apply(ki,r(["Firestore (7.19.0): "+t],e)))}function Di(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.0) INTERNAL ASSERTION FAILED: "+t;throw Oi(e),new Error(e)}function Vi(t){t||Pi()}var Ci=(Ui.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Ui);function Ui(){}function Mi(t,e){return t<e?-1:e<t?1:0}function qi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function xi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var ji=(Object.defineProperty(Fi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fi.prototype.isEqual=function(t){return t instanceof Fi&&t.projectId===this.projectId&&t.database===this.database},Fi.prototype.o=function(t){return Mi(this.projectId,t.projectId)||Mi(this.database,t.database)},Fi);function Fi(t,e){this.projectId=t,this.database=e||"(default)"}function Bi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $i,Wi,Hi,Qi=(lr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},lr.prototype.has=function(t){return void 0!==this.get(t)},lr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},lr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},lr.prototype.forEach=function(u){Gi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},lr.prototype._=function(){return zi(this.l)},lr),Xi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yi=(n(cr,Hi=Error),cr),Ki=(hr.now=function(){return hr.fromMillis(Date.now())},hr.fromDate=function(t){return hr.fromMillis(t.getTime())},hr.fromMillis=function(t){var e=Math.floor(t/1e3);return new hr(e,1e6*(t-1e3*e))},hr.prototype.toDate=function(){return new Date(this.toMillis())},hr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hr.prototype.m=function(t){return this.seconds===t.seconds?Mi(this.nanoseconds,t.nanoseconds):Mi(this.seconds,t.seconds)},hr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},hr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hr),Ji=(ar.T=function(t){return new ar(t)},ar.min=function(){return new ar(new Ki(0,0))},ar.prototype.o=function(t){return this.timestamp.m(t.timestamp)},ar.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ar.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ar.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ar.prototype.R=function(){return this.timestamp},ar),Zi=(Object.defineProperty(ur.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),ur.prototype.isEqual=function(t){return 0===ur.P(this,t)},ur.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ur?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ur.prototype.limit=function(){return this.offset+this.length},ur.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ur.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ur.prototype.v=function(){return this.segments[this.offset]},ur.prototype.S=function(){return this.get(this.length-1)},ur.prototype.get=function(t){return this.segments[this.offset+t]},ur.prototype._=function(){return 0===this.length},ur.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ur.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ur.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ur.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ur.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ur),tr=(n(sr,Wi=Zi),sr.prototype.V=function(t,e,n){return new sr(t,e,n)},sr.prototype.N=function(){return this.F().join("/")},sr.prototype.toString=function(){return this.N()},sr.$=function(t){if(0<=t.indexOf("//"))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new sr(t.split("/").filter(function(t){return 0<t.length}))},sr.k=function(){return new sr([])},sr),er=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nr=(n(or,$i=Zi),or.prototype.V=function(t,e,n){return new or(t,e,n)},or.O=function(t){return er.test(t)},or.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),or.O(t)||(t="`"+t+"`"),t}).join(".")},or.prototype.toString=function(){return this.N()},or.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},or.M=function(){return new or(["__name__"])},or.q=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Yi(Xi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yi(Xi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Yi(Xi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new or(e)},or.k=function(){return new or([])},or),ir=(rr.U=function(t){return new rr(tr.$(t))},rr.B=function(t){return new rr(tr.$(t).p(5))},rr.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},rr.prototype.isEqual=function(t){return null!==t&&0===tr.P(this.path,t.path)},rr.prototype.toString=function(){return this.path.toString()},rr.P=function(t,e){return tr.P(t.path,e.path)},rr.j=function(t){return t.length%2==0},rr.G=function(t){return new rr(new tr(t.slice()))},rr);function rr(t){this.path=t}function or(){return null!==$i&&$i.apply(this,arguments)||this}function sr(){return null!==Wi&&Wi.apply(this,arguments)||this}function ur(t,e,n){void 0===e?e=0:e>t.length&&Pi(),void 0===n?n=t.length-e:n>t.length-e&&Pi(),this.segments=t,this.offset=e,this.A=n}function ar(t){this.timestamp=t}function hr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yi(Xi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yi(Xi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yi(Xi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yi(Xi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function cr(t,e){var n=this;return(n=Hi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function lr(t,e){this.h=t,this.u=e,this.l={}}function fr(t){return null==t}function pr(t){return-0===t&&1/t==-1/0}var dr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.K=null};function yr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new dr(t,e,n,i,r,o,s)}function vr(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+wo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),fr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Bu(n.startAt)),n.endAt&&(e+="|ub:",e+=Bu(n.endAt)),n.K=e),n.K}function gr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!yo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zu(t.startAt,e.startAt)&&zu(t.endAt,e.endAt)}function mr(t){return ir.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wr=(br.fromBase64String=function(t){return new br(atob(t))},br.fromUint8Array=function(t){return new br(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},br.prototype.toBase64=function(){return t=this.H,btoa(t);var t},br.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},br.prototype.Y=function(){return 2*this.H.length},br.prototype.o=function(t){return Mi(this.H,t.H)},br.prototype.isEqual=function(t){return this.H===t.H},br);function br(t){this.H=t}wr.J=new wr("");function Er(t){this.count=t}var Ir,Ar,Tr=(Nr.prototype.tt=function(t){return new Nr(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Nr.prototype.et=function(t,e){return new Nr(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Nr.prototype.nt=function(t){return new Nr(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Nr);function Nr(t,e,n,i,r,o,s){void 0===r&&(r=Ji.min()),void 0===o&&(o=Ji.min()),void 0===s&&(s=wr.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.Z=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Rr(t){switch(t){case Xi.OK:return Pi(),0;case Xi.CANCELLED:case Xi.UNKNOWN:case Xi.DEADLINE_EXCEEDED:case Xi.RESOURCE_EXHAUSTED:case Xi.INTERNAL:case Xi.UNAVAILABLE:case Xi.UNAUTHENTICATED:return;case Xi.INVALID_ARGUMENT:case Xi.NOT_FOUND:case Xi.ALREADY_EXISTS:case Xi.PERMISSION_DENIED:case Xi.FAILED_PRECONDITION:case Xi.ABORTED:case Xi.OUT_OF_RANGE:case Xi.UNIMPLEMENTED:case Xi.DATA_LOSS:return 1;default:return Pi(),0}}function kr(t){if(void 0===t)return Oi("GRPC error has no .code"),Xi.UNKNOWN;switch(t){case Ir.OK:return Xi.OK;case Ir.CANCELLED:return Xi.CANCELLED;case Ir.UNKNOWN:return Xi.UNKNOWN;case Ir.DEADLINE_EXCEEDED:return Xi.DEADLINE_EXCEEDED;case Ir.RESOURCE_EXHAUSTED:return Xi.RESOURCE_EXHAUSTED;case Ir.INTERNAL:return Xi.INTERNAL;case Ir.UNAVAILABLE:return Xi.UNAVAILABLE;case Ir.UNAUTHENTICATED:return Xi.UNAUTHENTICATED;case Ir.INVALID_ARGUMENT:return Xi.INVALID_ARGUMENT;case Ir.NOT_FOUND:return Xi.NOT_FOUND;case Ir.ALREADY_EXISTS:return Xi.ALREADY_EXISTS;case Ir.PERMISSION_DENIED:return Xi.PERMISSION_DENIED;case Ir.FAILED_PRECONDITION:return Xi.FAILED_PRECONDITION;case Ir.ABORTED:return Xi.ABORTED;case Ir.OUT_OF_RANGE:return Xi.OUT_OF_RANGE;case Ir.UNIMPLEMENTED:return Xi.UNIMPLEMENTED;case Ir.DATA_LOSS:return Xi.DATA_LOSS;default:return Pi()}}(Ar=Ir=Ir||{})[Ar.OK=0]="OK",Ar[Ar.CANCELLED=1]="CANCELLED",Ar[Ar.UNKNOWN=2]="UNKNOWN",Ar[Ar.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ar[Ar.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ar[Ar.NOT_FOUND=5]="NOT_FOUND",Ar[Ar.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ar[Ar.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ar[Ar.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ar[Ar.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ar[Ar.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ar[Ar.ABORTED=10]="ABORTED",Ar[Ar.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ar[Ar.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ar[Ar.INTERNAL=13]="INTERNAL",Ar[Ar.UNAVAILABLE=14]="UNAVAILABLE",Ar[Ar.DATA_LOSS=15]="DATA_LOSS";var Sr=(Pr.prototype.st=function(t,e){return new Pr(this.P,this.root.st(t,e,this.P).copy(null,null,Or.it,null,null))},Pr.prototype.remove=function(t){return new Pr(this.P,this.root.remove(t,this.P).copy(null,null,Or.it,null,null))},Pr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pr.prototype._=function(){return this.root._()},Object.defineProperty(Pr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pr.prototype.rt=function(){return this.root.rt()},Pr.prototype.ot=function(){return this.root.ot()},Pr.prototype.ht=function(t){return this.root.ht(t)},Pr.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Pr.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pr.prototype.at=function(t){return this.root.at(t)},Pr.prototype.ut=function(){return new _r(this.root,null,this.P,!1)},Pr.prototype.ct=function(t){return new _r(this.root,t,this.P,!1)},Pr.prototype.lt=function(){return new _r(this.root,null,this.P,!0)},Pr.prototype._t=function(t){return new _r(this.root,t,this.P,!0)},Pr),_r=(Dr.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Dr.prototype.Tt=function(){return 0<this.dt.length},Dr.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Dr),Or=(Lr.prototype.copy=function(t,e,n,i,r){return new Lr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Lr.prototype._=function(){return!1},Lr.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Lr.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Lr.prototype.min=function(){return this.left._()?this:this.left.min()},Lr.prototype.rt=function(){return this.min().key},Lr.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Lr.prototype.st=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.st(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.st(t,e,n))).It()},Lr.prototype.Rt=function(){if(this.left._())return Lr.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.Rt(),null)).It()},Lr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.At()&&(i=i.Vt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.yt()),0===e(t,i.key)){if(i.right._())return Lr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Rt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.It()},Lr.prototype.At=function(){return this.color},Lr.prototype.It=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Vt()),t.left.At()&&t.right.At()&&(t=t.gt()),t},Lr.prototype.Pt=function(){var t=this.gt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).pt()).gt()),t},Lr.prototype.yt=function(){var t=this.gt();return t.left.left.At()&&(t=(t=t.Vt()).gt()),t},Lr.prototype.pt=function(){var t=this.copy(null,null,Lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Lr.prototype.Vt=function(){var t=this.copy(null,null,Lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Lr.prototype.gt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Lr.prototype.vt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Lr.prototype.bt=function(){if(this.At()&&this.left.At())throw Pi();if(this.right.At())throw Pi();var t=this.left.bt();if(t!==this.right.bt())throw Pi();return t+(this.At()?0:1)},Lr);function Lr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Lr.RED,this.left=null!=i?i:Lr.EMPTY,this.right=null!=r?r:Lr.EMPTY,this.size=this.left.size+1+this.right.size}function Dr(t,e,n,i){this.ft=i,this.dt=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.ft?t.left:t.right;else{if(0===r){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Pr(t,e){this.P=t,this.root=e||Or.EMPTY}function Vr(){this.size=0}Or.EMPTY=null,Or.RED=!0,Or.it=!1,Or.EMPTY=(Object.defineProperty(Vr.prototype,"key",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"value",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"color",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"left",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"right",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Vr.prototype.copy=function(t,e,n,i,r){return this},Vr.prototype.st=function(t,e,n){return new Or(t,e)},Vr.prototype.remove=function(t,e){return this},Vr.prototype._=function(){return!0},Vr.prototype.ht=function(t){return!1},Vr.prototype.at=function(t){return!1},Vr.prototype.rt=function(){return null},Vr.prototype.ot=function(){return null},Vr.prototype.At=function(){return!1},Vr.prototype.vt=function(){return!0},Vr.prototype.bt=function(){return 0},new Vr);var Cr=(xr.prototype.has=function(t){return null!==this.data.get(t)},xr.prototype.first=function(){return this.data.rt()},xr.prototype.last=function(){return this.data.ot()},Object.defineProperty(xr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xr.prototype.indexOf=function(t){return this.data.indexOf(t)},xr.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},xr.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var i=n.wt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},xr.prototype.Ct=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},xr.prototype.Dt=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},xr.prototype.ut=function(){return new Ur(this.data.ut())},xr.prototype.ct=function(t){return new Ur(this.data.ct(t))},xr.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},xr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xr.prototype._=function(){return this.data._()},xr.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xr.prototype.isEqual=function(t){if(!(t instanceof xr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(0!==this.P(i,r))return!1}return!0},xr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xr.prototype.copy=function(t){var e=new xr(this.P);return e.data=t,e},xr),Ur=(qr.prototype.wt=function(){return this.Nt.wt().key},qr.prototype.Tt=function(){return this.Nt.Tt()},qr),Mr=new Sr(ir.P);function qr(t){this.Nt=t}function xr(t){this.P=t,this.data=new Sr(this.P)}var jr=new Sr(ir.P);var Fr=new Sr(ir.P),Br=new Cr(ir.P);function Gr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Br,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var zr=new Cr(Mi);function $r(t,e,n,i){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=i}function Wr(t,e){this.targetId=t,this.ne=e}function Hr(t,e,n,i){void 0===n&&(n=wr.J),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Qr=(uo.Ot=function(t){return new uo(t.P)},uo.prototype.has=function(t){return null!=this.$t.get(t)},uo.prototype.get=function(t){return this.$t.get(t)},uo.prototype.first=function(){return this.kt.rt()},uo.prototype.last=function(){return this.kt.ot()},uo.prototype._=function(){return this.kt._()},uo.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.kt.ht(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.st(t.key,t),e.kt.st(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.kt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.ut(),n=t.kt.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(!i.isEqual(r))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.P=this.P,n.$t=t,n.kt=e,n},uo),Xr=(so.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.st(e,t):3===t.type&&1!==n.type?this.xt=this.xt.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):Pi()},so.prototype.Lt=function(){var n=[];return this.xt.ht(function(t,e){n.push(e)}),n},so),Yr=(oo.Wt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new oo(t,e,Qr.Ot(e),r,n,i,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ut===t.Ut&&this.qt.isEqual(t.qt)&&lu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Mt.isEqual(t.Mt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},oo),Kr=(ro.zt=function(t,e){var n=new Map;return n.set(t,Jr.Ht(t,e)),new ro(Ji.min(),n,zr,Mr,Gr())},ro),Jr=(io.Ht=function(t,e){return new io(wr.J,e,Gr(),Gr(),Gr())},io),Zr=(Object.defineProperty(no.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),no.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},no.prototype.le=function(){var n=Gr(),i=Gr(),r=Gr();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Pi()}}),new Jr(this.re,this.oe,n,i,r)},no.prototype._e=function(){this.he=!1,this.ie=ho()},no.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},no.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},no.prototype.we=function(){this.se+=1},no.prototype.me=function(){--this.se},no.prototype.Te=function(){this.he=!0,this.oe=!0},no),to=(eo.prototype.Ve=function(t){for(var e=0,n=t.te;e<n.length;e++){var i=n[e];t.ee instanceof Xs?this.ye(i,t.ee):t.ee instanceof Ys&&this.pe(i,t.key,t.ee)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.ee)}},eo.prototype.ge=function(n){var i=this;this.ve(n,function(t){var e=i.be(t);switch(n.state){case 0:i.Se(t)&&e.ce(n.resumeToken);break;case 1:e.me(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.me(),e.ae||i.removeTarget(t);break;case 3:i.Se(t)&&(e.Te(),e.ce(n.resumeToken));break;case 4:i.Se(t)&&(i.Ce(t),e.ce(n.resumeToken));break;default:Pi()}})},eo.prototype.ve=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){i.Se(e)&&n(e)})},eo.prototype.De=function(t){var e,n,i=t.targetId,r=t.ne.count,o=this.Fe(i);o&&(mr(e=o.target)?0===r?(n=new ir(e.path),this.pe(i,n,new Ys(n,Ji.min()))):Vi(1===r):this.Ne(i)!==r&&(this.Ce(i),this.Pe=this.Pe.add(i)))},eo.prototype.$e=function(r){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,i=o.Fe(e);i&&(t.Yt&&mr(i.target)&&(n=new ir(i.target.path),null!==o.Re.get(n)||o.ke(e,n)||o.pe(e,n,new Ys(n,r))),t.ue&&(s.set(e,t.le()),t._e()))});var i=Gr();this.Ae.forEach(function(t,e){var n=!0;e.Ct(function(t){var e=o.Fe(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Kr(r,s,this.Pe,this.Re,i);return this.Re=Mr,this.Ae=ao(),this.Pe=new Cr(Mi),t},eo.prototype.ye=function(t,e){var n;this.Se(t)&&(n=this.ke(t,e.key)?2:0,this.be(t).fe(e.key,n),this.Re=this.Re.st(e.key,e),this.Ae=this.Ae.st(e.key,this.Oe(e.key).add(t)))},eo.prototype.pe=function(t,e,n){var i;this.Se(t)&&(i=this.be(t),this.ke(t,e)?i.fe(e,1):i.de(e),this.Ae=this.Ae.st(e,this.Oe(e).delete(t)),n&&(this.Re=this.Re.st(e,n)))},eo.prototype.removeTarget=function(t){this.Ie.delete(t)},eo.prototype.Ne=function(t){var e=this.be(t).le();return this.Ee.xe(t).size+e.Jt.size-e.Zt.size},eo.prototype.we=function(t){this.be(t).we()},eo.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new Zr,this.Ie.set(t,e)),e},eo.prototype.Oe=function(t){var e=this.Ae.get(t);return e||(e=new Cr(Mi),this.Ae=this.Ae.st(t,e)),e},eo.prototype.Se=function(t){var e=null!==this.Fe(t);return e||_i("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.Fe=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.Ee.Le(t)},eo.prototype.Ce=function(e){var n=this;this.Ie.set(e,new Zr),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},eo.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},eo);function eo(t){this.Ee=t,this.Ie=new Map,this.Re=Mr,this.Ae=ao(),this.Pe=new Cr(Mi)}function no(){this.se=0,this.ie=ho(),this.re=wr.J,this.oe=!1,this.he=!0}function io(t,e,n,i,r){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=i,this.Zt=r}function ro(t,e,n,i,r){this.Z=t,this.Qt=e,this.jt=n,this.Gt=i,this.Kt=r}function oo(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Mt=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Ut=s,this.Bt=u}function so(){this.xt=new Sr(ir.P)}function uo(n){this.P=n?function(t,e){return n(t,e)||ir.P(t.key,e.key)}:function(t,e){return ir.P(t.key,e.key)},this.$t=jr,this.kt=new Sr(this.P)}function ao(){return new Sr(ir.P)}function ho(){return new Sr(ir.P)}function co(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=bo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ki(e.seconds,e.nanos)}var fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?co(t)?4:10:Pi()}function yo(i,r){var t,e,n,o=po(i);if(o!==po(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return lo(i).isEqual(lo(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=bo(i.timestampValue),n=bo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,Io(i.bytesValue).isEqual(Io(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Eo((t=i).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Eo(t.doubleValue),i=Eo(e.doubleValue);return n===i?pr(n)===pr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return qi(i.arrayValue.values||[],r.arrayValue.values||[],yo);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Bi(t)!==Bi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!yo(t[n],e[n])))return!1;return!0}();default:return Pi()}}function vo(t,e){return void 0!==(t.values||[]).find(function(t){return yo(t,e)})}function go(t,e){var n,i,r,o,s,u,a,h,c,l,f=po(t),p=po(e);if(f!==p)return Mi(f,p);switch(f){case 0:return 0;case 1:return Mi(t.booleanValue,e.booleanValue);case 2:return h=e,c=Eo(t.integerValue||t.doubleValue),l=Eo(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return mo(t.timestampValue,e.timestampValue);case 4:return mo(lo(t),lo(e));case 5:return Mi(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Io(o),a=Io(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Mi(n[r],i[r]);if(0!==o)return o}return Mi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Mi(Eo(n.latitude),Eo(i.latitude)))?r:Mi(Eo(n.longitude),Eo(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=go(n[r],i[r]);if(o)return o}return Mi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Mi(i[s],o[s]);if(0!==u)return u;var a=go(n[i[s]],r[o[s]]);if(0!==a)return a}return Mi(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Pi()}}function mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mi(t,e);var n=bo(t),i=bo(e),r=Mi(n.seconds,i.seconds);return 0!==r?r:Mi(n.nanos,i.nanos)}function wo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=bo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Io(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ir.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Pi();var t,e,n}(t)}function bo(t){if(Vi(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e,n=0,i=fo.exec(t);Vi(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Io(t){return"string"==typeof t?wr.fromBase64String(t):wr.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function To(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function Ro(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function So(t){return t&&"mapValue"in t}var _o={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Me=e};function Do(t){return{integerValue:""+t}}function Po(t,e){if(t.Me){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pr(e)?"-0":e}}function Vo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!pr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Do(e):Po(t,e);var n}function Co(t,e){return t.Me?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.Me?e.toBase64():e.toUint8Array()}function Mo(t){return Vi(!!t),Ji.T((e=bo(t),new Ki(e.seconds,e.nanos)));var e}function qo(t,e){return new tr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function xo(t,e){return qo(t.s,e.path)}function jo(t,e){var n,i,r=(Vi(Ho(i=tr.$(e))),i);return Vi(r.get(1)===t.s.projectId),Vi(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new ir((Vi(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Fo(t,e){return qo(t.s,e)}function Bo(t){return new tr(["projects",t.s.projectId,"databases",t.s.database]).N()}function Go(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,i,r,o,s,u;if(e instanceof Rs)n={update:Go(t,e.key,e.value)};else if(e instanceof Ms)n={delete:xo(t,e.key)};else if(e instanceof ks)n={update:Go(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Ds)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof Zo)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof rs)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.N(),increment:e.Ue};throw Pi()})}};else{if(!(e instanceof qs))return Pi();n={verify:xo(t,e.key)}}return e.We.Be||(n.currentDocument=void 0!==(o=e.We).updateTime?{updateTime:(s=t,u=o.updateTime,Co(s,u.R()))}:void 0!==o.exists?{exists:o.exists}:Pi()),n}function $o(t){return{before:t.before,values:t.position}}function Wo(t){return{fieldPath:t.N()}}function Ho(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Qo(){this.Qe=void 0}function Xo(t,e){return t instanceof as?To(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Yo,Ko,Jo=(n(es,Ko=Qo),es),Zo=(n(ts,Yo=Qo),ts);function ts(t){var e=this;return(e=Yo.call(this)||this).elements=t,e}function es(){return null!==Ko&&Ko.apply(this,arguments)||this}function ns(t,e){for(var n=ls(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return yo(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var is,rs=(n(os,is=Qo),os);function os(t){var e=this;return(e=is.call(this)||this).elements=t,e}function ss(t,e){for(var n=ls(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!yo(t,e)})}(r[i]);return{arrayValue:{values:n}}}var us,as=(n(hs,us=Qo),hs);function hs(t,e){var n=this;return(n=us.call(this)||this).serializer=t,n.Ue=e,n}function cs(t){return Eo(t.integerValue||t.doubleValue)}function ls(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fs(t,e){this.field=t,this.transform=e}var ps=(ds.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ds.prototype.isEqual=function(t){return qi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ds);function ds(t){(this.fields=t).sort(nr.P)}function ys(t,e){this.version=t,this.transformResults=e}var vs=(gs.Ge=function(){return new gs},gs.exists=function(t){return new gs(void 0,t)},gs.updateTime=function(t){return new gs(t)},Object.defineProperty(gs.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},gs);function gs(t,e){this.updateTime=t,this.exists=e}function ms(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}function ws(){}function bs(t,e,n){return t instanceof Rs?new Xs(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof ks?function(t,e,n){if(!ms(t.We,e))return new Ks(t.key,n.version);var i=Os(t,e);return new Xs(t.key,n.version,i,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ds?function(t,e,n){if(Vi(null!=n.transformResults),!ms(t.We,e))return new Ks(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Vi(t.length===n.length);for(var r,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Xs&&(c=e.field(a.field)),i.push((r=h,o=c,s=n[u],r instanceof Zo?ns(r,o):r instanceof rs?ss(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Vs(t,i.data(),r);return new Xs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new Ys(t.key,n.version,{hasCommittedMutations:!0})}function Es(t,e,n,i){return t instanceof Rs?function(t,e){if(!ms(t.We,e))return e;var n=As(e);return new Xs(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof ks?function(t,e){if(!ms(t.We,e))return e;var n=As(e),i=Os(t,e);return new Xs(t.key,n,i,{Ke:!0})}(t,e):t instanceof Ds?function(t,e,n,i){if(!ms(t.We,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,u,a,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],y=d.transform,v=null;n instanceof Xs&&(v=n.field(d.field)),null===v&&i instanceof Xs&&(v=i.field(d.field)),l.push((o=v,s=e,c=h=a=u=void 0,(r=y)instanceof Jo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):r instanceof Zo?ns(r,o):r instanceof rs?ss(r,o):(a=Xo(u=r,o),h=cs(a)+cs(u.Ue),To(a)&&To(u.Ue)?Do(h):Po(u.serializer,h))))}return l}(t.fieldTransforms,n,e,i),s=Vs(t,r.data(),o);return new Xs(t.key,r.version,s,{Ke:!0})}(t,e,i,n):(o=e,ms((r=t).We,o)?new Ys(r.key,Ji.min()):o);var r,o}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.We.isEqual(e.We)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||qi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof Zo&&o instanceof Zo||r instanceof rs&&o instanceof rs?qi(r.elements,o.elements,yo):r instanceof as&&o instanceof as?yo(r.Ue,o.Ue):r instanceof Jo&&o instanceof Jo);var n,i,r,o}))}function As(t){return t instanceof Xs?t.version:Ji.min()}var Ts,Ns,Rs=(n(_s,Ns=ws),_s),ks=(n(Ss,Ts=ws),Ss);function Ss(t,e,n,i){var r=this;return(r=Ts.call(this)||this).key=t,r.data=e,r.qe=n,r.We=i,r.type=1,r}function _s(t,e,n){var i=this;return(i=Ns.call(this)||this).key=t,i.value=e,i.We=n,i.type=0,i}function Os(t,e){return n=t,i=e instanceof Xs?e.data():xs.empty(),r=new js(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Ls,Ds=(n(Ps,Ls=ws),Ps);function Ps(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.We=vs.exists(!0),n}function Vs(t,e,n){for(var i=new js(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Cs,Us,Ms=(n(zs,Us=ws),zs),qs=(n(Gs,Cs=ws),Gs),xs=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!So(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Bs.prototype.isEqual=function(t){return yo(this.proto,t.proto)},Bs),js=(Fs.prototype.set=function(t,e){return this.Je(t,e),this},Fs.prototype.delete=function(t){return this.Je(t,null),this},Fs.prototype.Je=function(t,e){for(var n=this.Ye,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},Fs.prototype.ze=function(){var t=this.Xe(nr.k(),this.Ye);return null!=t?new xs(t):this.He},Fs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.He.field(i),s=So(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=xs.empty()),this.He=t,this.Ye=new Map}function Bs(t){this.proto=t}function Gs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.We=e,n.type=4,n}function zs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.We=e,n.type=3,n}function $s(t,e){this.key=t,this.version=e}var Ws,Hs,Qs,Xs=(n(tu,Qs=$s),tu.prototype.field=function(t){return this.Ze.field(t)},tu.prototype.data=function(){return this.Ze},tu.prototype.tn=function(){return this.Ze.proto},tu.prototype.isEqual=function(t){return t instanceof tu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},tu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu),Ys=(n(Zs,Hs=$s),Zs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Ks=(n(Js,Ws=$s),Js.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js);function Js(){return null!==Ws&&Ws.apply(this,arguments)||this}function Zs(t,e,n){var i=this;return(i=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function tu(t,e,n,i){var r=this;return(r=Qs.call(this,t,e)||this).Ze=n,r.Ke=!!i.Ke,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function eu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yi(Xi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yi(Xi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var nu=(iu.prototype.on=function(t){return new iu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},iu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.L())},iu.prototype.an=function(){return!fr(this.limit)&&"F"===this.nn},iu.prototype.un=function(){return!fr(this.limit)&&"L"===this.nn},iu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},iu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},iu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},iu);function iu(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=i,this.limit=r,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function ru(t){return new nu(t)}function ou(t){return null!==t.collectionGroup}function su(t){var e=eu(t,nu);if(null===e.sn){e.sn=[];var n=e.ln(),i=e.cn();if(null!==n&&null===i)n.L()||e.sn.push(new $u(n)),e.sn.push(new $u(nr.M(),"asc"));else{for(var r,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.L()&&(o=!0)}o||(r=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new $u(nr.M(),r)))}}return e.sn}function uu(t){var e=eu(t,nu);if(!e.rn)if("F"===e.nn)e.rn=yr(e.path,e.collectionGroup,su(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=su(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new $u(o.field,s))}var u=e.endAt?new Mu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Mu(e.startAt.position,!e.startAt.before):null;e.rn=yr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function au(t,e,n){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hu(t,e){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function cu(t,e){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function lu(t,e){return gr(uu(t),uu(e))&&t.nn===e.nn}function fu(t){return vr(uu(t))+"|lt:"+t.nn}function pu(t){return"Query(target="+(e=uu(t),n=e.path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+wo(e.value);var e}).join(", ")+"]"),fr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Bu(e.startAt)),e.endAt&&(n+=", endAt: "+Bu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function du(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.W(i.collectionGroup)&&i.path.C(o):ir.j(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.en;e<n.length;e++){var i=n[e];if(!i.field.L()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Gu(e.startAt,su(e),n))&&(!e.endAt||!Gu(e.endAt,su(e),n)));var e,n,i,o}function yu(u){return function(t,e){for(var n=!1,i=0,r=su(u);i<r.length;i++){var o=r[i],s=function(t,r,e){var n=t.field.L()?ir.P(r.key,e.key):function(t,e){var n=r.field(t),i=e.field(t);return null!==n&&null!==i?go(n,i):Pi()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pi()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var vu,gu=(n(mu,vu=function(){}),mu.create=function(t,e,n){if(t.L())return"in"===e||"not-in"===e?this.dn(t,e,n):new Iu(t,e,n);if(Ro(n)){if("=="!==e&&"!="!==e)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new mu(t,e,n)}if(ko(n)){if("=="!==e&&"!="!==e)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new mu(t,e,n)}return"array-contains"===e?new Pu(t,n):"in"===e?new Vu(t,n):"not-in"===e?new Cu(t,n):"array-contains-any"===e?new Uu(t,n):new mu(t,e,n)},mu.dn=function(t,e,n){return new("in"===e?Au:Tu)(t,n)},mu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(go(e,this.value)):null!==e&&po(this.value)===po(e)&&this.wn(go(e,this.value))},mu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pi()}},mu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},mu);function mu(t,e,n){var i=this;return(i=vu.call(this)||this).field=t,i.op=e,i.value=n,i}var wu,bu,Eu,Iu=(n(ku,Eu=gu),ku.prototype.matches=function(t){var e=ir.P(t.key,this.key);return this.wn(e)},ku),Au=(n(Ru,bu=gu),Ru.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ru),Tu=(n(Nu,wu=gu),Nu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Nu);function Nu(t,e){var n=this;return(n=wu.call(this,t,"not-in",e)||this).keys=Su(0,e),n}function Ru(t,e){var n=this;return(n=bu.call(this,t,"in",e)||this).keys=Su(0,e),n}function ku(t,e,n){var i=this;return(i=Eu.call(this,t,e,n)||this).key=ir.B(n.referenceValue),i}function Su(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ir.B(t.referenceValue)})}var _u,Ou,Lu,Du,Pu=(n(Fu,Du=gu),Fu.prototype.matches=function(t){var e=t.field(this.field);return No(e)&&vo(e.arrayValue,this.value)},Fu),Vu=(n(ju,Lu=gu),ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&vo(this.value.arrayValue,e)},ju),Cu=(n(xu,Ou=gu),xu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!vo(this.value.arrayValue,e)},xu),Uu=(n(qu,_u=gu),qu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!No(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return vo(e.value.arrayValue,t)})},qu),Mu=function(t,e){this.position=t,this.before=e};function qu(t,e){return _u.call(this,t,"array-contains-any",e)||this}function xu(t,e){return Ou.call(this,t,"not-in",e)||this}function ju(t,e){return Lu.call(this,t,"in",e)||this}function Fu(t,e){return Du.call(this,t,"array-contains",e)||this}function Bu(t){return(t.before?"b":"a")+":"+t.position.map(wo).join(",")}function Gu(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.L()?ir.P(ir.B(s.referenceValue),n.key):go(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function zu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yo(t.position[n],e.position[n]))return!1;return!0}var $u=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Wu=(ia.prototype.Tn=function(t,e,n){for(var i=n.En,r=0;r<this.mutations.length;r++){var o=this.mutations[r];o.key.isEqual(t)&&(e=bs(o,e,i[r]))}return e},ia.prototype.In=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=Es(r,e,e,this.mn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Es(a,e,o,this.mn))}return e},ia.prototype.Rn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.In(t.key,n.get(t.key));e&&(r=r.st(t.key,e))}),r},ia.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gr())},ia.prototype.isEqual=function(t){return this.batchId===t.batchId&&qi(this.mutations,t.mutations,Is)&&qi(this.baseMutations,t.baseMutations,Is)},ia),Hu=(na.from=function(t,e,n){Vi(t.mutations.length===n.length);for(var i=Fr,r=t.mutations,o=0;o<r.length;o++)i=i.st(r[o].key,n[o].version);return new na(t,e,n,i)},na),Qu=(ea.prototype.catch=function(t){return this.next(void 0,t)},ea.prototype.next=function(i,r){var o=this;return this.gn&&Pi(),this.gn=!0,this.pn?this.error?this.vn(r,this.error):this.bn(i,this.result):new ea(function(e,n){o.Vn=function(t){o.bn(i,t).next(e,n)},o.yn=function(t){o.vn(r,t).next(e,n)}})},ea.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ea.prototype.Cn=function(t){try{var e=t();return e instanceof ea?e:ea.resolve(e)}catch(t){return ea.reject(t)}},ea.prototype.bn=function(t,e){return t?this.Cn(function(){return t(e)}):ea.resolve(e)},ea.prototype.vn=function(t,e){return t?this.Cn(function(){return t(e)}):ea.reject(e)},ea.resolve=function(n){return new ea(function(t,e){t(n)})},ea.reject=function(n){return new ea(function(t,e){e(n)})},ea.Dn=function(t){return new ea(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},ea.Fn=function(t){for(var n=ea.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?ea.resolve(t):e()})}(i[e]);return n},ea.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Dn(r)},ea),Xu=(ta.prototype.On=function(e,n){var i=this;return this.$n.xn(e,n).next(function(t){return i.Ln(e,n,t)})},ta.prototype.Ln=function(t,i,r){return this.Nn.Mn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].In(i,t);return t})},ta.prototype.qn=function(t,e,r){var o=Mr;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].In(t,e);o=o.st(t,e)}),o},ta.prototype.Un=function(e,t){var n=this;return this.Nn.getEntries(e,t).next(function(t){return n.Bn(e,t)})},ta.prototype.Bn=function(i,r){var o=this;return this.$n.Wn(i,r).next(function(t){var e=o.qn(i,r,t),n=Mr;return e.forEach(function(t,e){e=e||new Ys(t,Ji.min()),n=n.st(t,e)}),n})},ta.prototype.Qn=function(t,e,n){return i=e,ir.j(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.jn(t,e.path):ou(e)?this.Gn(t,e,n):this.Kn(t,e,n);var i},ta.prototype.jn=function(t,e){return this.On(t,new ir(e)).next(function(t){var e=jr;return t instanceof Xs&&(e=e.st(t.key,t)),e})},ta.prototype.Gn=function(n,i,r){var o=this,s=i.collectionGroup,u=jr;return this.kn.zn(n,s).next(function(t){return Qu.forEach(t,function(t){var e=i.on(t.child(s));return o.Kn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ta.prototype.Kn=function(e,n,t){var c,l,i=this;return this.Nn.Qn(e,n,t).next(function(t){return c=t,i.$n.Hn(e,n)}).next(function(t){return l=t,i.Yn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=Es(s,a,a,i.mn);c=h instanceof Xs?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){du(n,e)||(c=c.remove(t))}),c})},ta.prototype.Yn=function(t,e,n){for(var i=Gr(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Nn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(h=h.st(t,e))}),h})},ta),Yu=(Zu.Zn=function(t,e){for(var n=Gr(),i=Gr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Zu(t,e.fromCache,n,i)},Zu),Ku=(Ju.prototype.es=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ju.prototype.next=function(){var t=++this.previousValue;return this.ns&&this.ns(t),t},Ju);function Ju(t,e){var n=this;this.previousValue=t,e&&(e.ts=function(t){return n.es(t)},this.ns=function(t){return e.ss(t)})}function Zu(t,e,n,i){this.targetId=t,this.fromCache=e,this.Jn=n,this.Xn=i}function ta(t,e,n){this.Nn=t,this.$n=e,this.kn=n}function ea(t){var e=this;this.Vn=null,this.yn=null,this.result=void 0,this.error=void 0,this.pn=!1,this.gn=!1,t(function(t){e.pn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.pn=!0,e.error=t,e.yn&&e.yn(t)})}function na(t,e,n,i){this.batch=t,this.An=e,this.En=n,this.Pn=i}function ia(t,e,n,i){this.batchId=t,this.mn=e,this.baseMutations=n,this.mutations=i}Ku.rs=-1;function ra(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var oa=(sa.prototype.reset=function(){this.ls=0},sa.prototype.ds=function(){this.ls=this.cs},sa.prototype.ws=function(t){var e=this;this.cancel();var n=Math.floor(this.ls+this.ms()),i=Math.max(0,Date.now()-this.fs),r=Math.max(0,n-i);0<r&&_i("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.ls+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this._s=this.os.Ts(this.hs,r,function(){return e.fs=Date.now(),t()}),this.ls*=this.us,this.ls<this.as&&(this.ls=this.as),this.ls>this.cs&&(this.ls=this.cs)},sa.prototype.Es=function(){null!==this._s&&(this._s.Is(),this._s=null)},sa.prototype.cancel=function(){null!==this._s&&(this._s.cancel(),this._s=null)},sa.prototype.ms=function(){return(Math.random()-.5)*this.ls},sa);function sa(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.os=t,this.hs=e,this.as=n,this.us=i,this.cs=r,this.ls=0,this._s=null,this.fs=Date.now(),this.reset()}function ua(t){return"IndexedDbTransactionError"===t.name}function aa(){return"undefined"!=typeof document?document:null}var ha=(fa.ys=function(t,e,n,i,r){var o=new fa(t,e,Date.now()+n,i,r);return o.start(n),o},fa.prototype.start=function(t){var e=this;this.ps=setTimeout(function(){return e.gs()},t)},fa.prototype.Is=function(){return this.gs()},fa.prototype.cancel=function(t){null!==this.ps&&(this.clearTimeout(),this.Vs.reject(new Yi(Xi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},fa.prototype.gs=function(){var e=this;this.Rs.vs(function(){return null!==e.ps?(e.clearTimeout(),e.op().then(function(t){return e.Vs.resolve(t)})):Promise.resolve()})},fa.prototype.clearTimeout=function(){null!==this.ps&&(this.Ps(this),clearTimeout(this.ps),this.ps=null)},fa),ca=(Object.defineProperty(la.prototype,"xs",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),la.prototype.vs=function(t){this.enqueue(t)},la.prototype.Ls=function(t){this.Ms(),this.qs(t)},la.prototype.Us=function(){var t;this.Cs||(this.Cs=!0,(t=aa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Os))},la.prototype.enqueue=function(t){return this.Ms(),this.Cs?new Promise(function(t){}):this.qs(t)},la.prototype.Bs=function(t){var e=this;this.Ss.push(t),this.vs(function(){return e.Ws()})},la.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Ss.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ss[0]()];case 2:return t.sent(),this.Ss.shift(),this.ks.reset(),[3,4];case 3:if(!ua(e=t.sent()))throw e;return _i("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ss.length&&this.ks.ws(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},la.prototype.qs=function(t){var i=this,e=this.bs.then(function(){return i.Ns=!0,t().catch(function(t){throw i.Fs=t,i.Ns=!1,Oi("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Ns=!1,t})});return this.bs=e},la.prototype.Ts=function(t,e,n){var i=this;this.Ms(),-1<this.$s.indexOf(t)&&(e=0);var r=ha.ys(this,t,e,n,function(t){return i.Qs(t)});return this.Ds.push(r),r},la.prototype.Ms=function(){this.Fs&&Pi()},la.prototype.js=function(){},la.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.bs];case 1:t.sent(),t.label=2;case 2:if(e!==this.bs)return[3,0];t.label=3;case 3:return[2]}})})},la.prototype.Ks=function(t){for(var e=0,n=this.Ds;e<n.length;e++)if(n[e].hs===t)return!0;return!1},la.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Ds.sort(function(t,e){return t.As-e.As});for(var t=0,e=r.Ds;t<e.length;t++){var n=e[t];if(n.Is(),"all"!==i&&n.hs===i)break}return r.Gs()})},la.prototype.Hs=function(t){this.$s.push(t)},la.prototype.Qs=function(t){var e=this.Ds.indexOf(t);this.Ds.splice(e,1)},la);function la(){var e=this;this.bs=Promise.resolve(),this.Ss=[],this.Cs=!1,this.Ds=[],this.Fs=null,this.Ns=!1,this.$s=[],this.ks=new oa(this,"async_queue_retry"),this.Os=function(){var t=aa();t&&_i("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ks.Es()};var t=aa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Os)}function fa(t,e,n,i,r){this.Rs=t,this.hs=e,this.As=n,this.op=i,this.Ps=r,this.Vs=new ra,this.then=this.Vs.promise.then.bind(this.Vs.promise),this.Vs.promise.catch(function(t){})}function pa(t,e){if(Oi("AsyncQueue",e+": "+t),ua(t))return new Yi(Xi.UNAVAILABLE,e+": "+t);throw t}var da=(ya.Zs=function(t){return new ya(t,ya.ti,ya.ei)},ya);function ya(t,e,n){this.Ys=t,this.Js=e,this.Xs=n}da.ni=-1,da.si=1048576,da.ii=41943040,da.ti=10,da.ei=1e3,da.ri=new da(da.ii,da.ti,da.ei),da.oi=new da(da.ni,0,0);var va=(Aa.prototype.ai=function(t,e){return this.hi.add(e),Qu.resolve()},Aa.prototype.zn=function(t,e){return Qu.resolve(this.hi.getEntries(e))},Aa),ga=(Ia.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Cr(tr.P),r=!i.has(n);return this.index[e]=i.add(n),r},Ia.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Ia.prototype.getEntries=function(t){return(this.index[t]||new Cr(tr.P)).F()},Ia),ma=(Ea.prototype.next=function(){return this.ui+=2,this.ui},Ea.ci=function(){return new Ea(0)},Ea.li=function(){return new Ea(-1)},Ea),wa=(ba.prototype.yi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pi(t,n.fi)})},ba);function ba(t,e,n){this.persistence=t,this._i=e,this.fi=new Sr(Mi),this.di=new Qi(vr,gr),this.wi=Ji.min(),this.$n=t.mi(n),this.Ti=t.Ei(),this.Ii=t.Ri(),this.Ai=new Xu(this.Ti,this.$n,this.persistence.Pi()),this._i.Vi(this.Ai)}function Ea(t){this.ui=t}function Ia(){this.index={}}function Aa(){this.hi=new ga}function Ta(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,r,o,s,i,u,a=c.batch.keys(),h=l.Ti.gi({vi:!0});return e=l,n=t,o=h,s=(r=c).batch,i=s.keys(),u=Qu.resolve(),i.forEach(function(i){u=u.next(function(){return o.Mn(n,i)}).next(function(t){var e=t,n=r.Pn.get(i);Vi(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(i,e,r))&&o.bi(e,r.An)})}),u.next(function(){return e.$n.Si(n,s)}).next(function(){return h.apply(t)}).next(function(){return l.$n.Ci(t)}).next(function(){return l.Ai.Un(t,a)})})}function Na(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Di(t)})}function Ra(t,s){var c=t,l=s.Z,f=c.fi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var r=c.Ti.gi({vi:!0});f=c.fi;var h=[];s.Qt.forEach(function(t,e){var n,i,r,o,s,u=f.get(e);u&&(h.push(c.Ii.Fi(a,t.Zt,e).next(function(){return c.Ii.Ni(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(i=u.et(n,l).tt(a.$i),f=f.st(e,i),r=u,s=t,Vi(0<(o=i).resumeToken.Y()),(0===r.resumeToken.Y()||3e8<=o.Z.I()-r.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.Ii.ki(a,i))))});var t,o=Mr,n=Gr();return s.Gt.forEach(function(t,e){n=n.add(t)}),h.push(r.getEntries(a,n).next(function(i){s.Gt.forEach(function(t,e){var n=i.get(t);e instanceof Ys&&e.version.isEqual(Ji.min())?(r.Oi(t,l),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.bi(e,l),o=o.st(t,e)):_i("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Kt.has(t)&&h.push(c.persistence.Li.xi(a,t))})})),l.isEqual(Ji.min())||(t=c.Ii.Di(a).next(function(t){return c.Ii.Mi(a,a.$i,l)}),h.push(t)),Qu.Dn(h).next(function(){return r.apply(a)}).next(function(){return c.Ai.Bn(a,o)})}).then(function(t){return c.fi=f,t})}function ka(o,s,u){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:n=(e=o).fi.get(s),i=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",i,function(t){return e.persistence.Li.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ua(r=t.sent()))throw r;return _i("LocalStore","Failed to update sequence numbers for target "+s+": "+r),[3,5];case 5:return e.fi=e.fi.remove(s),e.di.delete(n.target),[2]}})})}function Sa(t,s,u){var a=t,h=Ji.min(),c=Gr();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,i=uu(s),(void 0!==(o=(r=t).di.get(i))?Qu.resolve(r.fi.get(o)):r.Ii.Ui(n,i)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Ii.Bi(e,t.targetId).next(function(t){c=t})}).next(function(){return a._i.Qn(e,s,u?h:Ji.min(),u?c:Gr())}).next(function(t){return{documents:t,Wi:c}});var t,n,i,r,o})}function _a(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Xi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return _i("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Oa=(Ca.prototype._=function(){return this.Qi._()},Ca.prototype.zi=function(t,e){var n=new La(t,e);this.Qi=this.Qi.add(n),this.Gi=this.Gi.add(n)},Ca.prototype.Hi=function(t,e){var n=this;t.forEach(function(t){return n.zi(t,e)})},Ca.prototype.Yi=function(t,e){this.Ji(new La(t,e))},Ca.prototype.Xi=function(t,e){var n=this;t.forEach(function(t){return n.Yi(t,e)})},Ca.prototype.Zi=function(t){var e=this,n=new ir(new tr([])),i=new La(n,t),r=new La(n,t+1),o=[];return this.Gi.St([i,r],function(t){e.Ji(t),o.push(t.key)}),o},Ca.prototype.tr=function(){var e=this;this.Qi.forEach(function(t){return e.Ji(t)})},Ca.prototype.Ji=function(t){this.Qi=this.Qi.delete(t),this.Gi=this.Gi.delete(t)},Ca.prototype.er=function(t){var e=new ir(new tr([])),n=new La(e,t),i=new La(e,t+1),r=Gr();return this.Gi.St([n,i],function(t){r=r.add(t.key)}),r},Ca.prototype.nr=function(t){var e=new La(t,0),n=this.Qi.Dt(e);return null!==n&&t.isEqual(n.key)},Ca),La=(Va.ji=function(t,e){return ir.P(t.key,e.key)||Mi(t.sr,e.sr)},Va.Ki=function(t,e){return Mi(t.sr,e.sr)||ir.P(t.key,e.key)},Va),Da=(Pa.prototype.ir=function(){return null!=this.uid},Pa.prototype.rr=function(){return this.ir()?"uid:"+this.uid:"anonymous-user"},Pa.prototype.isEqual=function(t){return t.uid===this.uid},Pa);function Pa(t){this.uid=t}function Va(t,e){this.key=t,this.sr=e}function Ca(){this.Qi=new Cr(La.ji),this.Gi=new Cr(La.Ki)}Da.UNAUTHENTICATED=new Da(null),Da.or=new Da("google-credentials-uid"),Da.hr=new Da("first-party-uid");function Ua(t,e){this.user=e,this.type="OAuth",this.ar={},this.ar.Authorization="Bearer "+t}function Ma(t){this.key=t}function qa(t){this.key=t}function xa(t,e,n){this.query=t,this.targetId=e,this.view=n}function ja(t){this.key=t,this.Lh=!1}function Fa(){this.va=void 0,this.listeners=[]}var Ba,Ga,za,$a,Wa=(_h.prototype.getToken=function(){return Promise.resolve(null)},_h.prototype.cr=function(){},_h.prototype.lr=function(t){(this.ur=t)(Da.UNAUTHENTICATED)},_h.prototype._r=function(){this.ur=null},_h),Ha=(Sh.prototype.getToken=function(){var e=this,n=this.mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.mr!==n?(_i("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vi("string"==typeof t.accessToken),new Ua(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Sh.prototype.cr=function(){this.forceRefresh=!0},Sh.prototype.lr=function(t){this.ur=t,this.wr&&t(this.currentUser)},Sh.prototype._r=function(){this.auth&&this.auth.removeAuthTokenListener(this.dr),this.dr=null,this.ur=null},Sh.prototype.Tr=function(){var t=this.auth&&this.auth.getUid();return Vi(null===t||"string"==typeof t),new Da(t)},Sh),Qa=(Object.defineProperty(kh.prototype,"ar",{get:function(){var t={"X-Goog-AuthUser":this.Ir},e=this.Er.auth.Rr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),kh),Xa=(Rh.prototype.getToken=function(){return Promise.resolve(new Qa(this.Er,this.Ir))},Rh.prototype.lr=function(t){t(Da.hr)},Rh.prototype._r=function(){},Rh.prototype.cr=function(){},Rh),Ya=(Nh.prototype.gr=function(){return 1===this.state||2===this.state||4===this.state},Nh.prototype.vr=function(){return 2===this.state},Nh.prototype.start=function(){3!==this.state?this.auth():this.br()},Nh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Nh.prototype.Sr=function(){this.state=0,this.ks.reset()},Nh.prototype.Cr=function(){var t=this;this.vr()&&null===this.pr&&(this.pr=this.os.Ts(this.Ar,6e4,function(){return t.Dr()}))},Nh.prototype.Fr=function(t){this.Nr(),this.stream.send(t)},Nh.prototype.Dr=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.vr()?[2,this.close(0)]:[2]})})},Nh.prototype.Nr=function(){this.pr&&(this.pr.cancel(),this.pr=null)},Nh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Nr(),this.ks.cancel(),this.yr++,3!==e?this.ks.reset():n&&n.code===Xi.RESOURCE_EXHAUSTED?(Oi(n.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.ks.ds()):n&&n.code===Xi.UNAUTHENTICATED&&this.Vr.cr(),null!==this.stream&&(this.$r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.kr(n)];case 1:return t.sent(),[2]}})})},Nh.prototype.$r=function(){},Nh.prototype.auth=function(){var n=this;this.state=1;var t=this.Or(this.yr),e=this.yr;this.Vr.getToken().then(function(t){n.yr===e&&n.xr(t)},function(e){t(function(){var t=new Yi(Xi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Lr(t)})})},Nh.prototype.xr=function(t){var e=this,n=this.Or(this.yr);this.stream=this.Mr(t),this.stream.qr(function(){n(function(){return e.state=2,e.listener.qr()})}),this.stream.kr(function(t){n(function(){return e.Lr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Nh.prototype.br=function(){var t=this;this.state=4,this.ks.ws(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Nh.prototype.Lr=function(t){return _i("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Nh.prototype.Or=function(e){var n=this;return function(t){n.os.vs(function(){return n.yr===e?t():(_i("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Nh),Ka=(n(Th,za=Ya),Th.prototype.Mr=function(t){return this.Pr.Ur("Listen",t)},Th.prototype.onMessage=function(t){this.ks.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pi(),u=e.targetChange.targetIds||[],a=(r=e.targetChange.resumeToken,t.Me?(Vi(void 0===r||"string"==typeof r),wr.fromBase64String(r||"")):(Vi(void 0===r||r instanceof Uint8Array),wr.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=h&&(i=void 0===(n=h).code?Xi.UNKNOWN:kr(n.code),new Yi(i,n.message||"")),l=new Hr(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=jo(t,f.document.name),d=Mo(f.document.updateTime),y=new xs({mapValue:{fields:f.document.fields}}),v=new Xs(p,d,y,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new $r(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=jo(t,w.document),E=w.readTime?Mo(w.readTime):Ji.min(),I=new Ys(b,E),A=w.removedTargetIds||[];l=new $r([],A,I.key,I)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var N=jo(t,T.document),R=T.removedTargetIds||[];l=new $r([],R,N,null)}else{if(!("filter"in e))return Pi();e.filter;var k=e.filter;k.targetId;var S=k.count||0,_=new Er(S),O=k.targetId;l=new Wr(O,_)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ji.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ji.min():Mo(e.readTime)}(t);return this.listener.Br(e,n)},Th.prototype.Wr=function(t){var e,n,i,r,o={};o.database=Bo(this.serializer),o.addTarget=(e=this.serializer,r=(n=t).target,(i=mr(r)?{documents:{documents:[Fo(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Fo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ko(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NAN"}};if(Ro(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wo(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Wo((e=t).field),direction:(n=e.dir,_o[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Me||fr(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.Y()&&(i.resumeToken=Uo(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pi()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Fr(o)},Th.prototype.Qr=function(t){var e={};e.database=Bo(this.serializer),e.removeTarget=t,this.Fr(e)},Th),Ja=(n(Ah,Ga=Ya),Object.defineProperty(Ah.prototype,"Gr",{get:function(){return this.jr},enumerable:!1,configurable:!0}),Ah.prototype.start=function(){this.jr=!1,this.lastStreamToken=void 0,Ga.prototype.start.call(this)},Ah.prototype.$r=function(){this.jr&&this.Kr([])},Ah.prototype.Mr=function(t){return this.Pr.Ur("Write",t)},Ah.prototype.onMessage=function(t){if(Vi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.jr){this.ks.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Vi(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(Ji.min())&&(n=Mo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new ys(n,i)}(t,r)})):[]),n=Mo(t.commitTime);return this.listener.zr(n,e)}var i,r;return Vi(!t.writeResults||0===t.writeResults.length),this.jr=!0,this.listener.Hr()},Ah.prototype.Yr=function(){var t={};t.database=Bo(this.serializer),this.Fr(t)},Ah.prototype.Kr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.Fr(n)},Ah),Za=(n(Ih,Ba=function(){}),Ih.prototype.Xr=function(){if(this.Jr)throw new Yi(Xi.FAILED_PRECONDITION,"The client has already been terminated.")},Ih.prototype.Zr=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.Zr(e,n,i,t)}).catch(function(t){throw t.code===Xi.UNAUTHENTICATED&&r.credentials.cr(),t})},Ih.prototype.to=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.to(e,n,i,t)}).catch(function(t){throw t.code===Xi.UNAUTHENTICATED&&r.credentials.cr(),t})},Ih.prototype.terminate=function(){this.Jr=!1},Ih),th=(Eh.prototype.ro=function(){var t=this;0===this.no&&(this.oo("Unknown"),this.so=this.Rs.Ts("online_state_timeout",1e4,function(){return t.so=null,t.ho("Backend didn't respond within 10 seconds."),t.oo("Offline"),Promise.resolve()}))},Eh.prototype.ao=function(t){"Online"===this.state?this.oo("Unknown"):(this.no++,1<=this.no&&(this.uo(),this.ho("Connection failed 1 times. Most recent error: "+t.toString()),this.oo("Offline")))},Eh.prototype.set=function(t){this.uo(),this.no=0,"Online"===t&&(this.io=!1),this.oo(t)},Eh.prototype.oo=function(t){t!==this.state&&(this.state=t,this.eo(t))},Eh.prototype.ho=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.io?(Oi(e),this.io=!1):_i("OnlineStateTracker",e)},Eh.prototype.uo=function(){null!==this.so&&(this.so.cancel(),this.so=null)},Eh),eh=(bh.prototype.start=function(){return this.enableNetwork()},bh.prototype.enableNetwork=function(){return this.wo.delete(0),this.Co()},bh.prototype.Co=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(this.Do()?this.Fo():this.Ro.set("Unknown"),[4,this.No()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},bh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(0),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),[2]}})})},bh.prototype.$o=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.po.stop()];case 1:return t.sent(),[4,this.Ao.stop()];case 2:return t.sent(),0<this._o.length&&(_i("RemoteStore","Stopping write stream with "+this._o.length+" pending writes"),this._o=[]),this.ko(),[2]}})})},bh.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return _i("RemoteStore","RemoteStore shutting down."),this.wo.add(5),[4,this.$o()];case 1:return t.sent(),this.mo.Oo(),this.Ro.set("Unknown"),[2]}})})},bh.prototype.listen=function(t){this.fo.has(t.targetId)||(this.fo.set(t.targetId,t),this.Do()?this.Fo():this.Ao.vr()&&this.xo(t))},bh.prototype.Lo=function(t){this.fo.delete(t),this.Ao.vr()&&this.Mo(t),0===this.fo.size&&(this.Ao.vr()?this.Ao.Cr():this.Eo()&&this.Ro.set("Unknown"))},bh.prototype.Le=function(t){return this.fo.get(t)||null},bh.prototype.xe=function(t){return this.qo.xe(t)},bh.prototype.xo=function(t){this.do.we(t.targetId),this.Ao.Wr(t)},bh.prototype.Mo=function(t){this.do.we(t),this.Ao.Qr(t)},bh.prototype.Fo=function(){this.do=new to(this),this.Ao.start(),this.Ro.ro()},bh.prototype.Do=function(){return this.Eo()&&!this.Ao.gr()&&0<this.fo.size},bh.prototype.Eo=function(){return 0===this.wo.size},bh.prototype.ko=function(){this.do=null},bh.prototype.Po=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fo.forEach(function(t,e){n.xo(t)}),[2]})})},bh.prototype.Vo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ko(),this.Do()?(this.Ro.ao(e),this.Fo()):this.Ro.set("Unknown"),[2]})})},bh.prototype.yo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.Ro.set("Online"),!(r instanceof Hr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Uo(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),_i("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Bo(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof $r?this.do.Ve(r):r instanceof Wr?this.do.De(r):this.do.ge(r),o.isEqual(Ji.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Na(this.co)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Wo(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return _i("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Bo(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},bh.prototype.Bo=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ua(n))throw n;return this.wo.add(1),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),i=i||function(){return Na(e.co)},this.Rs.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return _i("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.wo.delete(1),[4,this.Co()];case 2:return t.sent(),[2]}})})}),[2]}})})},bh.prototype.Qo=function(e){var n=this;return e().catch(function(t){return n.Bo(t,e)})},bh.prototype.Wo=function(i){var r=this,t=this.do.$e(i);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=r.fo.get(e))&&r.fo.set(e,n.et(t.resumeToken,i))}),t.jt.forEach(function(t){var e,n=r.fo.get(t);n&&(r.fo.set(t,n.et(wr.J,n.Z)),r.Mo(t),e=new Tr(n.target,t,1,n.sequenceNumber),r.xo(e))}),this.qo.jo(t)},bh.prototype.Uo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.fo.has(r)?[4,this.qo.Go(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.fo.delete(r),this.do.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},bh.prototype.No=function(){return d(this,void 0,void 0,function(){var r,o,s;return y(this,function(t){switch(t.label){case 0:r=0<this._o.length?this._o[this._o.length-1].batchId:-1,t.label=1;case 1:if(!this.Ko())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.co,n=r,(i=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),i.$n.qi(t,n)}))];case 3:return null===(o=t.sent())?(0===this._o.length&&this.po.Cr(),[3,7]):(r=o.batchId,this.zo(o),[3,6]);case 4:return s=t.sent(),[4,this.Bo(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ho()&&this.Yo(),[2]}var e,n,i})})},bh.prototype.Ko=function(){return this.Eo()&&this._o.length<10},bh.prototype.Jo=function(){return this._o.length},bh.prototype.zo=function(t){this._o.push(t),this.po.vr()&&this.po.Gr&&this.po.Kr(t.mutations)},bh.prototype.Ho=function(){return this.Eo()&&!this.po.gr()&&0<this._o.length},bh.prototype.Yo=function(){this.po.start()},bh.prototype.vo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.po.Yr(),[2]})})},bh.prototype.So=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this._o;e<n.length;e++)i=n[e],this.po.Kr(i.mutations);return[2]})})},bh.prototype.zr=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this._o.shift(),n=Hu.from(e,r,o),[4,this.Qo(function(){return i.qo.Xo(n)})];case 1:return t.sent(),[4,this.No()];case 2:return t.sent(),[2]}})})},bh.prototype.bo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.po.Gr?[4,this.Zo(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ho()&&this.Yo(),[2]}})})},bh.prototype.Zo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Rr(n=r.code)&&n!==Xi.ABORTED?(e=this._o.shift(),this.po.Sr(),[4,this.Qo(function(){return i.qo.th(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.No()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},bh.prototype.Io=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(4),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),this.po.Sr(),this.Ao.Sr(),this.wo.delete(4),[4,this.Co()];case 2:return t.sent(),[2]}})})},bh.prototype.eh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rs.js(),_i("RemoteStore","RemoteStore received new credentials"),this.wo.add(3),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),[4,this.qo.eh(e)];case 2:return t.sent(),this.wo.delete(3),[4,this.Co()];case 3:return t.sent(),[2]}})})},bh.prototype.nh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.wo.delete(2),[4,this.Co()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.wo.add(2),[4,this.$o()]);case 3:t.sent(),this.Ro.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},bh),nh=(wh.prototype.sh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},wh.prototype.ih=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},wh.prototype.rh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},wh),ih=(mh.prototype.ah=function(t){},mh.prototype.uh=function(t,e,n){},mh.prototype.lh=function(t){return this.oh.sh(t),this.hh[t]||"not-current"},mh.prototype._h=function(t,e,n){this.hh[t]=e},mh.prototype.fh=function(t){this.oh.ih(t)},mh.prototype.dh=function(t){return this.oh.activeTargetIds.has(t)},mh.prototype.wh=function(t){delete this.hh[t]},mh.prototype.mh=function(){return this.oh.activeTargetIds},mh.prototype.Th=function(t){return this.oh.activeTargetIds.has(t)},mh.prototype.start=function(){return this.oh=new nh,Promise.resolve()},mh.prototype.Eh=function(t,e,n){},mh.prototype.Ih=function(t){},mh.prototype.Oo=function(){},mh.prototype.ss=function(t){},mh),rh=(Object.defineProperty(gh.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),gh.prototype.gh=function(t,e){var u=this,a=e?e.vh:new Xr,h=e?e.yh:this.yh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.un()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),i=(i=e instanceof Xs?e:null)&&(du(u.query,i)?i:null),r=!!n&&u.qt.has(n.key),o=!!i&&(i.Ke||u.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.bh(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.Vh(i,p)||d&&u.Vh(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.an()||this.query.un())for(;l.size>this.query.limit;){var n=this.query.an()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{yh:l,vh:a,Sh:f,qt:c}},gh.prototype.bh=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},gh.prototype.Ch=function(t,e,n){var o=this,i=this.yh;this.yh=t.yh,this.qt=t.qt;var r=t.vh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.Vh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pi()}}var i,r}),this.Dh(n);var s=e?this.Fh():[],u=0===this.Ph.size&&this.Yt?1:0,a=u!==this.Ah;return this.Ah=u,0!==r.length||a?{snapshot:new Yr(this.query,t.yh,i,r,t.qt,0==u,a,!1),Nh:s}:{Nh:s}},gh.prototype.$h=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Ch({yh:this.yh,vh:new Xr,qt:this.qt,Sh:!1},!1)):{Nh:[]}},gh.prototype.kh=function(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).Ke},gh.prototype.Dh=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.Rh=e.Rh.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.Rh=e.Rh.delete(t)}),this.Yt=t.Yt)},gh.prototype.Fh=function(){var e=this;if(!this.Yt)return[];var n=this.Ph;this.Ph=Gr(),this.yh.forEach(function(t){e.kh(t.key)&&(e.Ph=e.Ph.add(t.key))});var i=[];return n.forEach(function(t){e.Ph.has(t)||i.push(new qa(t))}),this.Ph.forEach(function(t){n.has(t)||i.push(new Ma(t))}),i},gh.prototype.Oh=function(t){this.Rh=t.Wi,this.Ph=Gr();var e=this.gh(t.documents);return this.Ch(e,!0)},gh.prototype.xh=function(){return Yr.Wt(this.query,this.yh,this.qt,0===this.Ah)},gh),oh=(Object.defineProperty(vh.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),vh.prototype.subscribe=function(t){this.Bh=t},vh.prototype.listen=function(h){return d(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return this.ta("listen()"),(s=this.Wh.get(h))?(n=s.targetId,this.qh.lh(n),o=s.view.xh(),[3,4]):[3,1];case 1:return[4,(e=this.co,i=uu(h),(r=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.Ui(e,i).next(function(t){return t?(n=t,Qu.resolve(n)):r.Ii.ea(e).next(function(t){return n=new Tr(i,t,0,e.$i),r.Ii.na(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(r.fi=r.fi.st(t.targetId,t),r.di.set(i,t.targetId)),t}))];case 2:return u=t.sent(),a=this.qh.lh(u.targetId),n=u.targetId,[4,this.sa(h,n,"current"===a)];case 3:o=t.sent(),this.Zh&&this.Mh.listen(u),t.label=4;case 4:return[2,o]}var e,i,r})})},vh.prototype.sa=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,Sa(this.co,u,!0)];case 1:return e=t.sent(),n=new rh(u,e.Wi),i=n.gh(e.documents),r=Jr.Ht(a,h&&"Offline"!==this.onlineState),o=n.Ch(i,this.Zh,r),this.ia(a,o.Nh),s=new xa(u,a,n),[2,(this.Wh.set(u,s),this.Qh.has(a)?this.Qh.get(a).push(u):this.Qh.set(a,[u]),o.snapshot)]}})})},vh.prototype.Lo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ta("unlisten()"),e=this.Wh.get(r),1<(n=this.Qh.get(e.targetId)).length?[2,(this.Qh.set(e.targetId,n.filter(function(t){return!lu(t,r)})),void this.Wh.delete(r))]:this.Zh?(this.qh.fh(e.targetId),this.qh.Th(e.targetId)?[3,2]:[4,ka(this.co,e.targetId,!1).then(function(){i.qh.wh(e.targetId),i.Mh.Lo(e.targetId),i.ra(e.targetId)}).catch(_a)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ra(e.targetId),[4,ka(this.co,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},vh.prototype.write=function(s,u){return d(this,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:this.ta("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.co,h=s,l=e,f=Ki.now(),n=h.reduce(function(t,e){return t.add(e.key)},Gr()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ai.Un(a,n).next(function(t){c=t;for(var u,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(u=o,e=c.get(o.key),u instanceof Ds?function(t){for(var e=null,n=0,i=u.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Xs?t.field(r.field):void 0,s=Xo(r.transform,o||null);null!=s&&(e=null==e?(new js).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new ks(o.key,s,function u(t){var a=[];return Gi(t.fields||{},function(t,e){var n=new nr([t]);if(So(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new ps(a)}(s.proto.mapValue),vs.exists(!0)))}return l.$n.oa(a,f,n,h)})}).then(function(t){var e=t.Rn(c);return{batchId:t.batchId,ha:e}}))];case 2:return i=t.sent(),this.qh.ah(i.batchId),this.aa(i.batchId,u),[4,this.ua(i.ha)];case 3:return t.sent(),[4,this.Mh.No()];case 4:return t.sent(),[3,6];case 5:return r=t.sent(),o=pa(r,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,l,f,n})})},vh.prototype.jo=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.ta("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ra(this.co,n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=i.Kh.get(e);n&&(Vi(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.Lh=!0:0<t.Xt.size?Vi(n.Lh):0<t.Zt.size&&(Vi(n.Lh),n.Lh=!1))}),[4,this.ua(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,_a(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vh.prototype.$h=function(i,t){var r;(this.Zh&&0===t||!this.Zh&&1===t)&&(this.ta("applyOnlineStateChange()"),r=[],this.Wh.forEach(function(t,e){var n=e.view.$h(i);n.snapshot&&r.push(n.snapshot)}),this.Bh.ca(i),this.Bh.Br(r),this.onlineState=i,this.Zh&&this.qh.Ih(i))},vh.prototype.Go=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ta("rejectListens()"),this.qh._h(u,"rejected",a),e=this.Kh.get(u),(n=e&&e.key)?(i=(i=new Sr(ir.P)).st(n,new Ys(n,Ji.min())),r=Gr().add(n),o=new Kr(Ji.min(),new Map,new Cr(Mi),i,r),[4,this.jo(o)]):[3,2];case 1:return t.sent(),this.Gh=this.Gh.remove(n),this.Kh.delete(u),this.la(),[3,4];case 2:return[4,ka(this.co,u,!1).then(function(){return s.ra(u,a)}).catch(_a)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},vh.prototype.Xo=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.ta("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ta(this.co,i)];case 2:return n=t.sent(),this._a(e,null),this.fa(e),this.qh.uh(e,"acknowledged"),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,_a(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vh.prototype.th=function(o,s){return d(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:this.ta("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,i=o,(r=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.$n.da(e,i).next(function(t){return Vi(null!==t),n=t.keys(),r.$n.Si(e,t)}).next(function(){return r.$n.Ci(e)}).next(function(){return r.Ai.Un(e,n)})}))];case 2:return n=t.sent(),this._a(o,s),this.fa(o),this.qh.uh(o,"rejected",s),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,_a(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,i,r})})},vh.prototype.wa=function(u){return d(this,void 0,void 0,function(){var i,r,o,s;return y(this,function(t){switch(t.label){case 0:this.Mh.Eo()||_i("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.co,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.$n.ma(t)}))];case 2:return-1===(i=t.sent())?[2,void u.resolve()]:((r=this.Yh.get(i)||[]).push(u),this.Yh.set(i,r),[3,4]);case 3:return o=t.sent(),s=pa(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},vh.prototype.fa=function(t){(this.Yh.get(t)||[]).forEach(function(t){t.resolve()}),this.Yh.delete(t)},vh.prototype.Ta=function(e){this.Yh.forEach(function(t){t.forEach(function(t){t.reject(new Yi(Xi.CANCELLED,e))})}),this.Yh.clear()},vh.prototype.aa=function(t,e){var n=this.Hh[this.currentUser.rr()];n=(n=n||new Sr(Mi)).st(t,e),this.Hh[this.currentUser.rr()]=n},vh.prototype._a=function(t,e){var n,i=this.Hh[this.currentUser.rr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Hh[this.currentUser.rr()]=i)},vh.prototype.ra=function(t,e){var n=this;void 0===e&&(e=null),this.qh.fh(t);for(var i=0,r=this.Qh.get(t);i<r.length;i++){var o=r[i];this.Wh.delete(o),e&&this.Bh.Ea(o,e)}this.Qh.delete(t),this.Zh&&this.zh.Zi(t).forEach(function(t){n.zh.nr(t)||n.Ia(t)})},vh.prototype.Ia=function(t){var e=this.Gh.get(t);null!==e&&(this.Mh.Lo(e),this.Gh=this.Gh.remove(t),this.Kh.delete(e),this.la())},vh.prototype.ia=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Ma?(this.zh.zi(r.key,t),this.Ra(r)):r instanceof qa?(_i("SyncEngine","Document no longer in limbo: "+r.key),this.zh.Yi(r.key,t),this.zh.nr(r.key)||this.Ia(r.key)):Pi()}},vh.prototype.Ra=function(t){var e=t.key;this.Gh.get(e)||(_i("SyncEngine","New document in limbo: "+e),this.jh.push(e),this.la())},vh.prototype.la=function(){for(;0<this.jh.length&&this.Gh.size<this.Uh;){var t=this.jh.shift(),e=this.Jh.next();this.Kh.set(e,new ja(t)),this.Gh=this.Gh.st(t,e),this.Mh.listen(new Tr(uu(ru(t.path)),e,2,Ku.rs))}},vh.prototype.Aa=function(){return this.Gh},vh.prototype.Pa=function(){return this.jh},vh.prototype.ua=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wh.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.gh(i);return n.Sh?Sa(u.co,r.query,!1).then(function(t){var e=t.documents;return r.view.gh(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(r.targetId),i=r.view.Ch(t,u.Zh,n);u.ia(r.targetId,i.Nh),i.snapshot&&(u.Zh&&u.qh._h(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Yu.Zn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bh.Br(o),[4,function(c,l){return d(this,void 0,void 0,function(){var i,e,n,r,o,s,u,a,h;return y(this,function(t){switch(t.label){case 0:i=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Qu.forEach(l,function(e){return Qu.forEach(e.Jn,function(t){return i.persistence.Li.zi(n,e.targetId,t)}).next(function(){return Qu.forEach(e.Xn,function(t){return i.persistence.Li.Yi(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ua(e=t.sent()))throw e;return _i("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,r=l;n<r.length;n++)o=r[n],s=o.targetId,o.fromCache||(u=i.fi.get(s),a=u.Z,h=u.nt(a),i.fi=i.fi.st(s,h));return[2]}})})}(this.co,s)];case 2:return t.sent(),[2]}})})},vh.prototype.ta=function(t){},vh.prototype.eh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(_i("SyncEngine","User change. New user:",n.rr()),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,m,i;return y(this,function(t){switch(t.label){case 0:return n=(e=r).$n,m=e.Ai,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.$n.Va(v).next(function(t){return g=t,n=e.persistence.mi(o),m=new Xu(e.Ti,n,e.persistence.Pi()),n.Va(v)}).next(function(t){for(var e=[],n=[],i=Gr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Un(v,i).next(function(t){return{ya:t,pa:e,ga:n}})})})];case 1:return i=t.sent(),[2,(e.$n=n,e.Ai=m,e._i.Vi(e.Ai),i)]}})})}(this.co,n)]);case 1:return e=t.sent(),this.currentUser=n,this.Ta("'waitForPendingWrites' promise is rejected due to a user change."),this.qh.Eh(n,e.pa,e.ga),[4,this.ua(e.ya)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},vh.prototype.xe=function(t){var e=this.Kh.get(t);if(e&&e.Lh)return Gr().add(e.key);var n=Gr(),i=this.Qh.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Wh.get(s),n=n.Ft(u.view.ph);return n},vh),sh=(yh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.ba.get(e))||(n=!0,i=new Fa),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.qo.listen(e)];case 2:return r.va=t.sent(),[3,4];case 3:return o=t.sent(),s=pa(o,"Initialization of query '"+pu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.ba.set(e,i),i.listeners.push(u),u.$h(this.onlineState),i.va&&u.Ca(i.va)&&this.Da(),[2]}})})},yh.prototype.Lo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.ba.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.ba.delete(e),this.qo.Lo(e))]:[2]})})},yh.prototype.Br=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.ba.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ca(r)&&(e=!0);s.va=r}}e&&this.Da()},yh.prototype.Ea=function(t,e){var n=this.ba.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.ba.delete(t)},yh.prototype.ca=function(r){this.onlineState=r;var o=!1;this.ba.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].$h(r)&&(o=!0)}),o&&this.Da()},yh.prototype.Fa=function(t){this.Sa.add(t),t.next()},yh.prototype.Na=function(t){this.Sa.delete(t)},yh.prototype.Da=function(){this.Sa.forEach(function(t){t.next()})},yh),uh=(dh.prototype.Ca=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Yr(t.query,t.docs,t.Mt,e,t.qt,t.fromCache,t.Ut,!0)}var o=!1;return this.ka?this.xa(t)&&(this.$a.next(t),o=!0):this.La(t,this.onlineState)&&(this.Ma(t),o=!0),this.Oa=t,o},dh.prototype.onError=function(t){this.$a.error(t)},dh.prototype.$h=function(t){this.onlineState=t;var e=!1;return this.Oa&&!this.ka&&this.La(this.Oa,t)&&(this.Ma(this.Oa),e=!0),e},dh.prototype.La=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qa&&n||t.docs._()&&"Offline"!==e)},dh.prototype.xa=function(t){if(0<t.docChanges.length)return!0;var e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ut&&!e)&&!0===this.options.includeMetadataChanges},dh.prototype.Ma=function(t){t=Yr.Wt(t.query,t.docs,t.qt,t.fromCache),this.ka=!0,this.$a.next(t)},dh),ah=(ph.prototype.Vi=function(t){this.Ua=t},ph.prototype.Qn=function(e,i,r,o){var s=this;return i.hn()||r.isEqual(Ji.min())?this.Ba(e,i):this.Ua.Un(e,o).next(function(t){var n=s.Wa(i,t);return(i.an()||i.un())&&s.Sh(i.nn,n,o,r)?s.Ba(e,i):(Si()<=u.DEBUG&&_i("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pu(i)),s.Ua.Qn(e,i,r).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},ph.prototype.Wa=function(n,t){var i=new Cr(yu(n));return t.forEach(function(t,e){e instanceof Xs&&du(n,e)&&(i=i.add(e))}),i},ph.prototype.Sh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},ph.prototype.Ba=function(t,e){return Si()<=u.DEBUG&&_i("IndexFreeQueryEngine","Using full collection scan to execute query:",pu(e)),this.Ua.Qn(t,e,Ji.min())},ph),hh=(fh.prototype.Ga=function(t){return Qu.resolve(0===this.$n.length)},fh.prototype.oa=function(t,e,n,i){var r=this.Qa;this.Qa++,0<this.$n.length&&this.$n[this.$n.length-1];var o=new Wu(r,e,n,i);this.$n.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.ja=this.ja.add(new La(a.key,r)),this.kn.ai(t,a.key.path.g())}return Qu.resolve(o)},fh.prototype.da=function(t,e){return Qu.resolve(this.Ka(e))},fh.prototype.qi=function(t,e){var n=e+1,i=this.za(n),r=i<0?0:i;return Qu.resolve(this.$n.length>r?this.$n[r]:null)},fh.prototype.ma=function(){return Qu.resolve(0===this.$n.length?-1:this.Qa-1)},fh.prototype.Va=function(t){return Qu.resolve(this.$n.slice())},fh.prototype.xn=function(t,e){var n=this,i=new La(e,0),r=new La(e,Number.POSITIVE_INFINITY),o=[];return this.ja.St([i,r],function(t){var e=n.Ka(t.sr);o.push(e)}),Qu.resolve(o)},fh.prototype.Wn=function(t,e){var i=this,r=new Cr(Mi);return e.forEach(function(t){var e=new La(t,0),n=new La(t,Number.POSITIVE_INFINITY);i.ja.St([e,n],function(t){r=r.add(t.sr)})}),Qu.resolve(this.Ha(r))},fh.prototype.Hn=function(t,e){var n=e.path,i=n.length+1,r=n;ir.j(r)||(r=r.child(""));var o=new La(new ir(r),0),s=new Cr(Mi);return this.ja.Ct(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.sr)),!0)},o),Qu.resolve(this.Ha(s))},fh.prototype.Ha=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ka(t);null!==e&&i.push(e)}),i},fh.prototype.Si=function(n,i){var r=this;Vi(0===this.Ya(i.batchId,"removed")),this.$n.shift();var o=this.ja;return Qu.forEach(i.mutations,function(t){var e=new La(t.key,i.batchId);return o=o.delete(e),r.Li.Ja(n,t.key)}).next(function(){r.ja=o})},fh.prototype.Xa=function(t){},fh.prototype.nr=function(t,e){var n=new La(e,0),i=this.ja.Dt(n);return Qu.resolve(e.isEqual(i&&i.key))},fh.prototype.Ci=function(t){return this.$n.length,Qu.resolve()},fh.prototype.Ya=function(t,e){return this.za(t)},fh.prototype.za=function(t){return 0===this.$n.length?0:t-this.$n[0].batchId},fh.prototype.Ka=function(t){var e=this.za(t);return e<0||e>=this.$n.length?null:this.$n[e]},fh),ch=(lh.prototype.bi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Za(e);return this.docs=this.docs.st(i,{tu:e,size:s,readTime:n}),this.size+=s-o,this.kn.ai(t,i.path.g())},lh.prototype.Oi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},lh.prototype.Mn=function(t,e){var n=this.docs.get(e);return Qu.resolve(n?n.tu:null)},lh.prototype.getEntries=function(t,e){var n=this,i=Mr;return e.forEach(function(t){var e=n.docs.get(t);i=i.st(t,e?e.tu:null)}),Qu.resolve(i)},lh.prototype.Qn=function(t,e,n){for(var i=jr,r=new ir(e.path.child("")),o=this.docs.ct(r);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.tu,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Xs&&du(e,h)&&(i=i.st(h.key,h))}return Qu.resolve(i)},lh.prototype.eu=function(t,e){return Qu.forEach(this.docs,function(t){return e(t)})},lh.prototype.gi=function(t){return new lh.nu(this)},lh.prototype.su=function(t){return Qu.resolve(this.size)},lh);function lh(t,e){this.kn=t,this.Za=e,this.docs=new Sr(ir.P),this.size=0}function fh(t,e){this.kn=t,this.Li=e,this.$n=[],this.Qa=1,this.ja=new Cr(La.ji)}function ph(){}function dh(t,e,n){this.query=t,this.$a=e,this.ka=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}function yh(t){this.qo=t,this.ba=new Qi(fu,lu),this.onlineState="Unknown",this.Sa=new Set,this.qo.subscribe(this)}function vh(t,e,n,i,r,o){this.co=t,this.Mh=e,this.lo=n,this.qh=i,this.currentUser=r,this.Uh=o,this.Bh=null,this.Wh=new Qi(fu,lu),this.Qh=new Map,this.jh=[],this.Gh=new Sr(ir.P),this.Kh=new Map,this.zh=new Oa,this.Hh={},this.Yh=new Map,this.Jh=ma.li(),this.onlineState="Unknown",this.Xh=void 0}function gh(t,e){this.query=t,this.Rh=e,this.Ah=null,this.Yt=!1,this.Ph=Gr(),this.qt=Gr(),this.Vh=yu(t),this.yh=new Qr(this.Vh)}function mh(){this.oh=new nh,this.hh={},this.eo=null,this.ts=null}function wh(){this.activeTargetIds=zr}function bh(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.co=t,this.lo=e,this.Rs=n,this._o=[],this.fo=new Map,this.do=null,this.wo=new Set,this.mo=r,this.mo.To(function(t){n.vs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(_i("RemoteStore","Restarting streams for network reachability change."),[4,this.Io()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ro=new th(n,i),this.Ao=(h=this.lo,c=n,l={qr:this.Po.bind(this),kr:this.Vo.bind(this),Br:this.yo.bind(this)},(f=h).Xr(),new Ka(c,f.Pr,f.credentials,f.serializer,l)),this.po=(o=this.lo,s=n,u={qr:this.vo.bind(this),kr:this.bo.bind(this),Hr:this.So.bind(this),zr:this.zr.bind(this)},(a=o).Xr(),new Ja(s,a.Pr,a.credentials,a.serializer,u))}function Eh(t,e){this.Rs=t,this.eo=e,this.state="Unknown",this.no=0,this.so=null,this.io=!0}function Ih(t,e,n){var i=this;return(i=Ba.call(this)||this).credentials=t,i.Pr=e,i.serializer=n,i.Jr=!1,i}function Ah(t,e,n,i,r){var o=this;return(o=Ga.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.jr=!1,o}function Th(t,e,n,i,r){var o=this;return(o=za.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Nh(t,e,n,i,r,o){this.os=t,this.Ar=n,this.Pr=i,this.Vr=r,this.listener=o,this.state=0,this.yr=0,this.pr=null,this.stream=null,this.ks=new oa(t,e)}function Rh(t,e){this.Er=t,this.Ir=e}function kh(t,e){this.Er=t,this.Ir=e,this.type="FirstParty",this.user=Da.hr}function Sh(t){var e=this;this.dr=null,this.currentUser=Da.UNAUTHENTICATED,this.wr=!1,this.mr=0,this.ur=null,this.forceRefresh=!1,this.dr=function(){e.mr++,e.currentUser=e.Tr(),e.wr=!0,e.ur&&e.ur(e.currentUser)},this.mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.dr):(this.dr(null),t.get().then(function(t){e.auth=t,e.dr&&e.auth.addAuthTokenListener(e.dr)},function(){}))}function _h(){this.ur=null}function Oh(t){var e=this;return(e=$a.call(this)||this).uu=t,e}function Lh(){this.ha=new Qi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.iu=!1}ch.nu=(Object.defineProperty(Lh.prototype,"readTime",{get:function(){return this.ru},set:function(t){this.ru=t},enumerable:!1,configurable:!0}),Lh.prototype.bi=function(t,e){this.ou(),this.readTime=e,this.ha.set(t.key,t)},Lh.prototype.Oi=function(t,e){this.ou(),e&&(this.readTime=e),this.ha.set(t,null)},Lh.prototype.Mn=function(t,e){this.ou();var n=this.ha.get(e);return void 0!==n?Qu.resolve(n):this.hu(t,e)},Lh.prototype.getEntries=function(t,e){return this.au(t,e)},Lh.prototype.apply=function(t){return this.ou(),this.iu=!0,this.Ch(t)},Lh.prototype.ou=function(){},n(Oh,$a=Lh),Oh.prototype.Ch=function(n){var i=this,r=[];return this.ha.forEach(function(t,e){e?r.push(i.uu.bi(n,e,i.readTime)):i.uu.Oi(t)}),Qu.Dn(r)},Oh.prototype.hu=function(t,e){return this.uu.Mn(t,e)},Oh.prototype.au=function(t,e){return this.uu.getEntries(t,e)},Oh);var Dh,Ph,Vh=(Jh.prototype.ve=function(t,n){return this.cu.forEach(function(t,e){return n(e)}),Qu.resolve()},Jh.prototype.Di=function(t){return Qu.resolve(this.lastRemoteSnapshotVersion)},Jh.prototype.du=function(t){return Qu.resolve(this.lu)},Jh.prototype.ea=function(t){return this.highestTargetId=this.fu.next(),Qu.resolve(this.highestTargetId)},Jh.prototype.Mi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lu&&(this.lu=e),Qu.resolve()},Jh.prototype.wu=function(t){this.cu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fu=new ma(e),this.highestTargetId=e),t.sequenceNumber>this.lu&&(this.lu=t.sequenceNumber)},Jh.prototype.na=function(t,e){return this.wu(e),this.targetCount+=1,Qu.resolve()},Jh.prototype.ki=function(t,e){return this.wu(e),Qu.resolve()},Jh.prototype.mu=function(t,e){return this.cu.delete(e.target),this._u.Zi(e.targetId),--this.targetCount,Qu.resolve()},Jh.prototype.Tu=function(n,i,r){var o=this,s=0,u=[];return this.cu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.cu.delete(t),u.push(o.Eu(n,e.targetId)),s++)}),Qu.Dn(u).next(function(){return s})},Jh.prototype.Iu=function(t){return Qu.resolve(this.targetCount)},Jh.prototype.Ui=function(t,e){var n=this.cu.get(e)||null;return Qu.resolve(n)},Jh.prototype.Ni=function(t,e,n){return this._u.Hi(e,n),Qu.resolve()},Jh.prototype.Fi=function(e,t,n){this._u.Xi(t,n);var i=this.persistence.Li,r=[];return i&&t.forEach(function(t){r.push(i.Ja(e,t))}),Qu.Dn(r)},Jh.prototype.Eu=function(t,e){return this._u.Zi(e),Qu.resolve()},Jh.prototype.Bi=function(t,e){var n=this._u.er(e);return Qu.resolve(n)},Jh.prototype.nr=function(t,e){return Qu.resolve(this._u.nr(e))},Jh),Ch=(Kh.prototype.start=function(){return Promise.resolve()},Kh.prototype.Oo=function(){return this.Pu=!1,Promise.resolve()},Object.defineProperty(Kh.prototype,"yu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),Kh.prototype.pu=function(){},Kh.prototype.gu=function(){},Kh.prototype.Pi=function(){return this.kn},Kh.prototype.mi=function(t){var e=this.Ru[t.rr()];return e||(e=new hh(this.kn,this.Li),this.Ru[t.rr()]=e),e},Kh.prototype.Ri=function(){return this.Ii},Kh.prototype.Ei=function(){return this.Nn},Kh.prototype.runTransaction=function(t,e,n){var i=this;_i("MemoryPersistence","Starting transaction:",t);var r=new Uh(this.Au.next());return this.Li.vu(),n(r).next(function(t){return i.Li.bu(r).next(function(){return t})}).Sn().then(function(t){return r.Su(),t})},Kh.prototype.Cu=function(e,n){return Qu.Fn(Object.values(this.Ru).map(function(t){return function(){return t.nr(e,n)}}))},Kh),Uh=(Yh.prototype.Fu=function(t){this.Du.push(t)},Yh.prototype.Su=function(){this.Du.forEach(function(t){return t()})},n(Xh,Ph=Yh),Xh),Mh=(Qh.ku=function(t){return new Qh(t)},Object.defineProperty(Qh.prototype,"Ou",{get:function(){if(this.$u)return this.$u;throw Pi()},enumerable:!1,configurable:!0}),Qh.prototype.zi=function(t,e,n){return this.Nu.zi(n,e),this.Ou.delete(n.toString()),Qu.resolve()},Qh.prototype.Yi=function(t,e,n){return this.Nu.Yi(n,e),this.Ou.add(n.toString()),Qu.resolve()},Qh.prototype.Ja=function(t,e){return this.Ou.add(e.toString()),Qu.resolve()},Qh.prototype.removeTarget=function(t,e){var n=this;this.Nu.Zi(e.targetId).forEach(function(t){return n.Ou.add(t.toString())});var i=this.persistence.Ri();return i.Bi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ou.add(t.toString())})}).next(function(){return i.mu(t,e)})},Qh.prototype.vu=function(){this.$u=new Set},Qh.prototype.bu=function(n){var i=this,r=this.persistence.Ei().gi();return Qu.forEach(this.Ou,function(t){var e=ir.U(t);return i.xu(n,e).next(function(t){t||r.Oi(e)})}).next(function(){return i.$u=null,r.apply(n)})},Qh.prototype.xi=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Ou.delete(e.toString()):n.Ou.add(e.toString())})},Qh.prototype.Vu=function(t){return 0},Qh.prototype.xu=function(t,e){var n=this;return Qu.Fn([function(){return Qu.resolve(n.Nu.nr(e))},function(){return n.persistence.Ri().nr(t,e)},function(){return n.persistence.Cu(t,e)}])},Qh),qh=(Hh.prototype.qr=function(t){this.qu=t},Hh.prototype.kr=function(t){this.Uu=t},Hh.prototype.onMessage=function(t){this.Bu=t},Hh.prototype.close=function(){this.Mu()},Hh.prototype.send=function(t){this.Lu(t)},Hh.prototype.Wu=function(){this.qu()},Hh.prototype.Qu=function(t){this.Uu(t)},Hh.prototype.ju=function(t){this.Bu(t)},Hh),xh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},jh=(Wh.prototype.Zr=function(e,t,n,i){var r=this.Hu(e,t);_i("RestConnection","Sending: ",r,n);var o={};return this.Yu(o,i),this.Ju(e,r,o,n).then(function(t){return _i("RestConnection","Received: ",t),t},function(t){throw Li("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Wh.prototype.to=function(t,e,n,i){return this.Zr(t,e,n,i)},Wh.prototype.Yu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.0",t["Content-Type"]="text/plain",e)for(var n in e.ar)e.ar.hasOwnProperty(n)&&(t[n]=e.ar[n])},Wh.prototype.Hu=function(t,e){var n=xh[t];return this.Ku+"/v1/"+e+":"+n},n($h,Dh=Wh),$h.prototype.Ju=function(a,e,n,i){return new Promise(function(o,s){var u=new Ti;u.listenOnce(Ii.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ei.NO_ERROR:var t=u.getResponseJson();_i("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ei.TIMEOUT:_i("Connection",'RPC "'+a+'" timed out'),s(new Yi(Xi.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:var e,n,i=u.getStatus();_i("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Xi).indexOf(r)?r:Xi.UNKNOWN,s(new Yi(n,e.message))):s(new Yi(Xi.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Yi(Xi.UNAVAILABLE,"Connection failed."));break;default:Pi()}}finally{_i("Connection",'RPC "'+a+'" completed.')}var r});var t=JSON.stringify(i);u.send(e,"POST",t,n,15)})},$h.prototype.Ur=function(t,e){var n,i,r=[this.Ku,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=bi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Yu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}_i("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new qh({Lu:function(t){l?_i("Connection","Not sending because WebChannel is closed:",t):(c||(_i("Connection","Opening WebChannel transport."),h.open(),c=!0),_i("Connection","WebChannel sending:",t),h.send(t))},Mu:function(){return h.close()}});return a(Ai.EventType.OPEN,function(){l||_i("Connection","WebChannel transport opened.")}),a(Ai.EventType.CLOSE,function(){l||(l=!0,_i("Connection","WebChannel transport closed"),f.Qu())}),a(Ai.EventType.ERROR,function(t){l||(l=!0,Li("Connection","WebChannel transport errored:",t),f.Qu(new Yi(Xi.UNAVAILABLE,"The operation could not be completed")))}),a(Ai.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Vi(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(_i("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Ir[r];if(void 0!==t)return kr(t)}(),s=i.message,void 0===o&&(o=Xi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Qu(new Yi(o,s)),h.close()):(_i("Connection","WebChannel received:",n),f.ju(n)))}),setTimeout(function(){f.Wu()},0),f},$h),Fh=(zh.prototype.To=function(t){this.nc.push(t)},zh.prototype.Oo=function(){window.removeEventListener("online",this.Xu),window.removeEventListener("offline",this.tc)},zh.prototype.sc=function(){window.addEventListener("online",this.Xu),window.addEventListener("offline",this.tc)},zh.prototype.Zu=function(){_i("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(0)},zh.prototype.ec=function(){_i("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(1)},zh.ic=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},zh),Bh=(Gh.prototype.To=function(t){},Gh.prototype.Oo=function(){},Gh);function Gh(){}function zh(){var t=this;this.Xu=function(){return t.Zu()},this.tc=function(){return t.ec()},this.nc=[],this.sc()}function $h(t){var e=this;return(e=Dh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Wh(t){this.Gu=t,this.s=t.s;var e=t.ssl?"https":"http";this.Ku=e+"://"+t.host,this.zu="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Hh(t){this.Lu=t.Lu,this.Mu=t.Mu}function Qh(t){this.persistence=t,this.Nu=new Oa,this.$u=null}function Xh(t){var e=this;return(e=Ph.call(this)||this).$i=t,e}function Yh(){this.Du=[]}function Kh(t){var e=this;this.Ru={},this.Au=new Ku(0),this.Pu=!1,this.Pu=!0,this.Li=t(this),this.Ii=new Vh(this),this.kn=new va,this.Nn=new ch(this.kn,function(t){return e.Li.Vu(t)})}function Jh(t){this.persistence=t,this.cu=new Qi(vr,gr),this.lastRemoteSnapshotVersion=Ji.min(),this.highestTargetId=0,this.lu=0,this._u=new Oa,this.targetCount=0,this.fu=ma.ci()}function Zh(t){return new Lo(t,!0)}var tc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ec=(rc.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.qh=this.rc(e),this.persistence=this.oc(e),[4,this.persistence.start()];case 1:return t.sent(),this.hc=this.ac(e),this.co=this.uc(e),[2]}})})},rc.prototype.ac=function(t){return null},rc.prototype.uc=function(t){return e=this.persistence,n=new ah,i=t.cc,new wa(e,n,i);var e,n,i},rc.prototype.oc=function(t){if(t._c.lc)throw new Yi(Xi.FAILED_PRECONDITION,tc);return new Ch(Mh.ku)},rc.prototype.rc=function(t){return new ih},rc.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.hc&&this.hc.stop(),[4,this.qh.Oo()];case 1:return t.sent(),[4,this.persistence.Oo()];case 2:return t.sent(),[2]}})})},rc.prototype.clearPersistence=function(t,e){throw new Yi(Xi.FAILED_PRECONDITION,tc)},rc),nc=(ic.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.co?[3,3]:(this.co=n.co,this.qh=n.qh,this.lo=this.fc(i),this.Mh=this.dc(i),this.qo=this.wc(i),this.mc=this.Tc(i),this.qh.eo=function(t){return e.qo.$h(t,1)},this.Mh.qo=this.qo,[4,this.Mh.start()]);case 1:return t.sent(),[4,this.Mh.nh(this.qo.Zh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ic.prototype.Tc=function(t){return new sh(this.qo)},ic.prototype.fc=function(t){var e,n,i=Zh(t.Gu.s),r=(e=t.Gu,new jh(e));return n=t.credentials,new Za(n,r,i)},ic.prototype.dc=function(t){var e=this;return new eh(this.co,this.lo,t.Rs,function(t){return e.qo.$h(t,0)},new(Fh.ic()?Fh:Bh))},ic.prototype.wc=function(t){return e=this.co,n=this.Mh,i=this.lo,r=this.qh,o=t.cc,s=t.Uh,u=!t._c.lc||!t._c.synchronizeTabs,a=new oh(e,n,i,r,o,s),u&&(a.Xh=!0),a;var e,n,i,r,o,s,u,a},ic.prototype.terminate=function(){return this.Mh.Oo()},ic);function ic(){}function rc(){}function oc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var sc=(uc.prototype.next=function(t){this.observer.next&&this.Ec(this.observer.next,t)},uc.prototype.error=function(t){this.observer.error?this.Ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},uc.prototype.Ic=function(){this.muted=!0},uc.prototype.Ec=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},uc);function uc(t){this.observer=t,this.muted=!1}function ac(t,e){if(0!==e.length)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Rc(e.length,"argument")+".")}function hc(t,e,n){if(e.length!==n)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires "+Rc(n,"argument")+", but was called with "+Rc(e.length,"argument")+".")}function cc(t,e,n){if(e.length<n)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Rc(n,"argument")+", but was called with "+Rc(e.length,"argument")+".")}function lc(t,e,n,i){if(e.length<n||e.length>i)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Rc(e.length,"argument")+".")}function fc(t,e,n,i){mc(t,e,Nc(n)+" argument",i)}function pc(t,e,n,i){void 0!==i&&fc(t,e,n,i)}function dc(t,e,n,i){mc(t,e,n+" option",i)}function yc(t,e,n,i){void 0!==i&&dc(t,e,n,i)}function vc(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(bc(s))}var u=bc(n);throw new Yi(Xi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function gc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid value "+bc(i)+" provided to function "+t+"() for its "+Nc(n)+" argument. Acceptable values: "+e.join(", "));return i}function mc(t,e,n,i){if(!("object"===e?wc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=bc(i);throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function wc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function bc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pi();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ec(t,e,n){if(void 0===n)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Nc(e)+" argument, but it was undefined.")}function Ic(n,t,i){Gi(t,function(t,e){if(i.indexOf(t)<0)throw new Yi(Xi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Ac(t,e,n,i){var r=bc(i);return new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Nc(n)+" argument to be a "+e+", but it was: "+r)}function Tc(t,e,n){if(n<=0)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Nc(e)+" argument to be a positive number, but it was: "+n+".")}function Nc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Rc(t,e){return t+" "+e+(1===t?"":"s")}function kc(){if("undefined"==typeof Uint8Array)throw new Yi(Xi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Sc(){if("undefined"==typeof atob)throw new Yi(Xi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var _c,Oc,Lc=(xc.fromBase64String=function(t){hc("Blob.fromBase64String",arguments,1),fc("Blob.fromBase64String","string",1,t),Sc();try{return new xc(wr.fromBase64String(t))}catch(t){throw new Yi(Xi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},xc.fromUint8Array=function(t){if(hc("Blob.fromUint8Array",arguments,1),kc(),!(t instanceof Uint8Array))throw Ac("Blob.fromUint8Array","Uint8Array",1,t);return new xc(wr.fromUint8Array(t))},xc.prototype.toBase64=function(){return hc("Blob.toBase64",arguments,0),Sc(),this.Rc.toBase64()},xc.prototype.toUint8Array=function(){return hc("Blob.toUint8Array",arguments,0),kc(),this.Rc.toUint8Array()},xc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},xc.prototype.isEqual=function(t){return this.Rc.isEqual(t.Rc)},xc),Dc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yi(Xi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(fc("FieldPath","string",e,t[e]),0===t[e].length)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ac=new nr(t)},Pc=(n(qc,Oc=Dc),qc.documentId=function(){return new qc(nr.M().N())},qc.prototype.isEqual=function(t){if(!(t instanceof qc))throw Ac("isEqual","FieldPath",1,t);return this.Ac.isEqual(t.Ac)},qc),Vc=new RegExp("[~\\*/\\[\\]]"),Cc=function(){this.Pc=this},Uc=(n(Mc,_c=Cc),Mc.prototype.yc=function(t){if(2!==t.pc)throw 1===t.pc?t.gc(this.Vc+"() can only appear at the top level of your update data"):t.gc(this.Vc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Mc.prototype.isEqual=function(t){return t instanceof Mc},Mc);function Mc(t){var e=this;return(e=_c.call(this)||this).Vc=t,e}function qc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Oc.call(this,t)||this}function xc(t){Sc(),this.Rc=t}function jc(t,e,n){return new dl({pc:3,vc:e.settings.vc,methodName:t.Vc,bc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Fc,Bc,Gc,zc,$c,Wc,Hc=(n(fl,Wc=Cc),fl.prototype.yc=function(t){return new fs(t.path,new Jo)},fl.prototype.isEqual=function(t){return t instanceof fl},fl),Qc=(n(ll,$c=Cc),ll.prototype.yc=function(t){var e=jc(this,t,!0),n=this.Sc.map(function(t){return Il(t,e)}),i=new Zo(n);return new fs(t.path,i)},ll.prototype.isEqual=function(t){return this===t},ll),Xc=(n(cl,zc=Cc),cl.prototype.yc=function(t){var e=jc(this,t,!0),n=this.Sc.map(function(t){return Il(t,e)}),i=new rs(n);return new fs(t.path,i)},cl.prototype.isEqual=function(t){return this===t},cl),Yc=(n(hl,Gc=Cc),hl.prototype.yc=function(t){var e=new as(t.serializer,Vo(t.serializer,this.Cc));return new fs(t.path,e)},hl.prototype.isEqual=function(t){return this===t},hl),Kc=(n(al,Bc=Cc),al.delete=function(){return ac("FieldValue.delete",arguments),new Jc(new Uc("FieldValue.delete"))},al.serverTimestamp=function(){return ac("FieldValue.serverTimestamp",arguments),new Jc(new Hc("FieldValue.serverTimestamp"))},al.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return cc("FieldValue.arrayUnion",arguments,1),new Jc(new Qc("FieldValue.arrayUnion",t))},al.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return cc("FieldValue.arrayRemove",arguments,1),new Jc(new Xc("FieldValue.arrayRemove",t))},al.increment=function(t){return fc("FieldValue.increment","number",1,t),hc("FieldValue.increment",arguments,1),new Jc(new Yc("FieldValue.increment",t))},al),Jc=(n(ul,Fc=Kc),ul.prototype.yc=function(t){return this.Pc.yc(t)},ul.prototype.isEqual=function(t){return t instanceof ul&&this.Pc.isEqual(t.Pc)},ul),Zc=(Object.defineProperty(sl.prototype,"latitude",{get:function(){return this.Dc},enumerable:!1,configurable:!0}),Object.defineProperty(sl.prototype,"longitude",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),sl.prototype.isEqual=function(t){return this.Dc===t.Dc&&this.Fc===t.Fc},sl.prototype.toJSON=function(){return{latitude:this.Dc,longitude:this.Fc}},sl.prototype.m=function(t){return Mi(this.Dc,t.Dc)||Mi(this.Fc,t.Fc)},sl),tl=/^__.*__$/,el=function(t,e,n){this.Nc=t,this.$c=e,this.kc=n},nl=(ol.prototype.Oc=function(t,e){var n=[];return null!==this.qe?n.push(new ks(t,this.data,this.qe,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},ol),il=(rl.prototype.Oc=function(t,e){var n=[new ks(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},rl);function rl(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function ol(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function sl(t,e){if(hc("GeoPoint",arguments,2),fc("GeoPoint","number",1,t),fc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yi(Xi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yi(Xi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Dc=t,this.Fc=e}function ul(t){var e=this;return(e=Fc.call(this)||this).Pc=t,e.Vc=t.Vc,e}function al(){return Bc.call(this)||this}function hl(t,e){var n=this;return(n=Gc.call(this)||this).Vc=t,n.Cc=e,n}function cl(t,e){var n=this;return(n=zc.call(this)||this).Vc=t,n.Sc=e,n}function ll(t,e){var n=this;return(n=$c.call(this)||this).Vc=t,n.Sc=e,n}function fl(t){var e=this;return(e=Wc.call(this)||this).Vc=t,e}function pl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pi()}}var dl=(Object.defineProperty(gl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(gl.prototype,"pc",{get:function(){return this.settings.pc},enumerable:!1,configurable:!0}),gl.prototype.Lc=function(t){return new gl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},gl.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.qc(t),i},gl.prototype.Uc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.xc(),i},gl.prototype.Bc=function(t){return this.Lc({path:void 0,bc:!0})},gl.prototype.gc=function(t){return Sl(t,this.settings.methodName,this.settings.Wc||!1,this.path,this.settings.vc)},gl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},gl.prototype.xc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qc(this.path.get(t))},gl.prototype.qc=function(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(pl(this.pc)&&tl.test(t))throw this.gc('Document fields cannot begin and end with "__"')},gl),yl=(vl.prototype.Qc=function(t,e,n,i){return void 0===i&&(i=!1),new dl({pc:t,methodName:e,vc:n,path:nr.k(),bc:!1,Wc:i},this.s,this.serializer,this.ignoreUndefinedProperties)},vl);function vl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Zh(t)}function gl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.qe=o||[]}function ml(t,e,n,i,r,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,r);Nl("Data must be an object, but it was:",s,i);var u,a,h=Al(i,s);if(o.merge)u=new ps(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Dc)d=p.Ac;else{if("string"!=typeof p)throw Pi();d=kl(e,p,n)}if(!s.contains(d))throw new Yi(Xi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");_l(c,d)||c.push(d)}u=new ps(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new nl(new xs(h),u,a)}function wl(t,o,s,e){var u=t.Qc(1,o,s);Nl("Data must be an object, but it was:",u,e);var a=[],h=new js;Gi(e,function(t,e){var n,i=kl(o,t,s),r=u.Uc(i);e instanceof Cc&&e.Pc instanceof Uc?a.push(i):null!=(n=Il(e,r))&&(a.push(i),h.set(i,n))});var n=new ps(a);return new il(h.ze(),n,u.fieldTransforms)}function bl(t,e,n,i,r,o){var s=t.Qc(1,e,n),u=[Rl(e,i,n)],a=[r];if(o.length%2!=0)throw new Yi(Xi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Rl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new js,v=u.length-1;0<=v;--v){_l(d,u[v])||(c=u[v],l=a[v],f=s.Uc(c),l instanceof Cc&&l.Pc instanceof Uc?d.push(c):null!=(p=Il(l,f))&&(d.push(c),y.set(c,p)))}var g=new ps(d);return new il(y.ze(),g,s.fieldTransforms)}function El(t,e,n,i){return void 0===i&&(i=!1),Il(n,t.Qc(i?4:3,e))}function Il(s,t){if(Tl(s))return Nl("Unsupported field value:",t,s),Al(s,t);if(s instanceof Cc)return function(t,e){if(!pl(e.pc))throw e.gc(t.Vc+"() can only be used with update() and set()");if(!e.path)throw e.gc(t.Vc+"() is not currently supported inside arrays");var n=t.yc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.bc&&4!==t.pc)throw t.gc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Il(r[i],t.Bc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ki.fromDate(t);return{timestampValue:Co(e.serializer,n)}}if(t instanceof Ki){var i=new Ki(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Co(e.serializer,i)}}if(t instanceof Zc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Lc)return{bytesValue:Uo(e.serializer,t)};if(t instanceof el){var r=e.s,o=t.Nc;if(!o.isEqual(r))throw e.gc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:qo(t.Nc||e.s,t.$c.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.gc("Unsupported field value: "+bc(t))}(s,t)}function Al(t,i){var r={};return zi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):Gi(t,function(t,e){var n=Il(e,i.Mc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Tl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ki||t instanceof Zc||t instanceof Lc||t instanceof el||t instanceof Cc)}function Nl(t,e,n){if(!Tl(n)||!wc(n)){var i=bc(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function Rl(t,e,n){if(e instanceof Dc)return e.Ac;if("string"==typeof e)return kl(t,e);throw Sl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function kl(t,e,n){try{return function(e){if(0<=e.search(Vc))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Pc.bind.apply(Pc,r([void 0],e.split("."))))}catch(t){throw new Yi(Xi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ac}catch(e){throw Sl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Sl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+i),s&&(a+=" in document "+r),a+=")"),new Yi(Xi.INVALID_ARGUMENT,(u+=". ")+t+a)}function _l(t,e){return t.some(function(t){return t.isEqual(e)})}var Ol=(Cl.prototype.Hc=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),0<this.mutations.length)throw new Yi(Xi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Bo((r=u).serializer)+"/documents",n={documents:a.map(function(t){return xo(r.serializer,t)})},[4,r.to("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Vi(!!e.found),e.found.name,e.found.updateTime;var n=jo(t,e.found.name),i=Mo(e.found.updateTime),r=new xs({mapValue:{fields:e.found.fields}});return new Xs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Vi(!!e.missing),Vi(!!e.readTime);var n=jo(t,e.missing),i=Mo(e.readTime);return new Ys(n,i)}(e,n):Pi());o.set(i.key.toString(),i)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Vi(!!e),s.push(e)}),s)]}})})}(this.lo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ys||t instanceof Xs?n.Jc(t):Pi()}),e)]}})})},Cl.prototype.set=function(t,e){this.write(e.Oc(t,this.We(t))),this.zc.add(t.toString())},Cl.prototype.update=function(t,e){try{this.write(e.Oc(t,this.Xc(t)))}catch(t){this.Kc=t}this.zc.add(t.toString())},Cl.prototype.delete=function(t){this.write([new Ms(t,this.We(t))]),this.zc.add(t.toString())},Cl.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),this.Kc)throw this.Kc;return e=this.jc,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=ir.U(e);i.mutations.push(new qs(n,i.We(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Bo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return zo(e.serializer,t)})},[4,e.Zr("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.lo,this.mutations)];case 1:return t.sent(),this.Gc=!0,[2]}})})},Cl.prototype.Jc=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof Ys))throw Pi();e=Ji.min()}var n=this.jc.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yi(Xi.ABORTED,"Document version changed between two reads.")}else this.jc.set(t.key.toString(),e)},Cl.prototype.We=function(t){var e=this.jc.get(t.toString());return!this.zc.has(t.toString())&&e?vs.updateTime(e):vs.Ge()},Cl.prototype.Xc=function(t){var e=this.jc.get(t.toString());if(this.zc.has(t.toString())||!e)return vs.exists(!0);if(e.isEqual(Ji.min()))throw new Yi(Xi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},Cl.prototype.write=function(t){this.Yc(),this.mutations=this.mutations.concat(t)},Cl.prototype.Yc=function(){},Cl),Ll=(Vl.prototype.run=function(){this.tl()},Vl.prototype.tl=function(){var t=this;this.ks.ws(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new Ol(this.lo),(n=this.el(e))&&n.then(function(t){i.Rs.vs(function(){return e.commit().then(function(){i.Vs.resolve(t)}).catch(function(t){i.nl(t)})})}).catch(function(t){i.nl(t)}),[2]})})})},Vl.prototype.el=function(t){try{var e=this.updateFunction(t);return!fr(e)&&e.catch&&e.then?e:(this.Vs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vs.reject(t),null}},Vl.prototype.nl=function(t){var e=this;0<this.Zc&&this.sl(t)?(--this.Zc,this.Rs.vs(function(){return e.tl(),Promise.resolve()})):this.Vs.reject(t)},Vl.prototype.sl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Rr(e)},Vl),Dl=(Pl.prototype.start=function(t,e,n,i){var r=this;this.rl(),this.Gu=t;var o=new ra,s=!1;return this.credentials.lr(function(t){return s?void r.Rs.Bs(function(){return r.Mh.eh(t)}):(s=!0,_i("FirestoreClient","Initializing. user=",t.uid),r.ol(e,n,i,t,o).then(r.il.resolve,r.il.reject))}),this.Rs.vs(function(){return r.il.promise}),o.promise},Pl.prototype.enableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!0),t.Mh.enableNetwork()})},Pl.prototype.ol=function(r,o,s,u,a){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Rs:this.Rs,Gu:this.Gu,clientId:this.clientId,credentials:this.credentials,cc:u,Uh:100,_c:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.qh=r.qh,this.co=r.co,this.hc=r.hc,this.lo=o.lo,this.Mh=o.Mh,this.qo=o.qo,this.hl=o.mc,this.persistence.pu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.ol(new ec,new nc,{lc:!1},u,a))];case 4:return[2]}})})},Pl.prototype.al=function(t){return"FirebaseError"===t.name?t.code===Xi.FAILED_PRECONDITION||t.code===Xi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Pl.prototype.rl=function(){if(this.Rs.xs)throw new Yi(Xi.FAILED_PRECONDITION,"The client has already been terminated.")},Pl.prototype.disableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!1),t.Mh.disableNetwork()})},Pl.prototype.terminate=function(){var t=this;this.Rs.Us();var i=new ra;return this.Rs.Ls(function(){return d(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.hc&&this.hc.stop(),[4,this.Mh.Oo()];case 1:return t.sent(),[4,this.qh.Oo()];case 2:return t.sent(),[4,this.persistence.Oo()];case 3:return t.sent(),this.credentials._r(),i.resolve(),[3,5];case 4:return e=t.sent(),n=pa(e,"Failed to shutdown persistence"),i.reject(n),[3,5];case 5:return[2]}})})}),i.promise},Pl.prototype.waitForPendingWrites=function(){var t=this;this.rl();var e=new ra;return this.Rs.vs(function(){return t.qo.wa(e)}),e.promise},Pl.prototype.listen=function(t,e,n){var i=this;this.rl();var r=new sc(n),o=new uh(t,r,e);return this.Rs.vs(function(){return i.hl.listen(o)}),function(){r.Ic(),i.Rs.vs(function(){return i.hl.Lo(o)})}},Pl.prototype.ul=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,u,a){return d(this,void 0,void 0,function(){var s,e=this;return y(this,function(t){switch(t.label){case 0:return s=new ra,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Ai.On(t,e)}))];case 1:return(i=t.sent())instanceof Xs?s.resolve(i):i instanceof Ys?s.resolve(null):s.reject(new Yi(Xi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),o=pa(r,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.Rs,this.co,e))]}})})},Pl.prototype.cl=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ra,s=Ul(e,n,ru(i.path),{includeMetadataChanges:!0,qa:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Yi(Xi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Yi(Xi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Pl.prototype.ll=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,a,h){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return u=new ra,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Sa(a,h,!0)];case 1:return e=t.sent(),n=new rh(h,e.Wi),i=n.gh(e.documents),r=n.Ch(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=pa(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.Rs,this.co,e))]}})})},Pl.prototype._l=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ra,s=Ul(e,n,i,{includeMetadataChanges:!0,qa:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Yi(Xi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Pl.prototype.write=function(t){var e=this;this.rl();var n=new ra;return this.Rs.vs(function(){return e.qo.write(t,n)}),n.promise},Pl.prototype.s=function(){return this.Gu.s},Pl.prototype.Fa=function(t){var e=this;this.rl();var n=new sc(t);return this.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Fa(n)]})})}),function(){n.Ic(),e.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Na(n)]})})})}},Object.defineProperty(Pl.prototype,"fl",{get:function(){return this.Rs.xs},enumerable:!1,configurable:!0}),Pl.prototype.transaction=function(t){var e=this;this.rl();var n=new ra;return this.Rs.vs(function(){return new Ll(e.Rs,e.lo,t,n).run(),Promise.resolve()}),n.promise},Pl);function Pl(t,e){this.credentials=t,this.Rs=e,this.clientId=Ci.t(),this.il=new ra}function Vl(t,e,n,i){this.Rs=t,this.lo=e,this.updateFunction=n,this.Vs=i,this.Zc=5,this.ks=new oa(this.Rs,"transaction_retry")}function Cl(t){this.lo=t,this.jc=new Map,this.mutations=[],this.Gc=!1,this.Kc=null,this.zc=new Set}function Ul(t,e,n,i,r){var o=new sc(r),s=new uh(n,o,i);return t.vs(function(){return e.listen(s)}),function(){o.Ic(),t.vs(function(){return e.Lo(s)})}}var Ml,ql,xl=(rf.prototype.ml=function(t){switch(po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Tl(t.timestampValue);case 4:return this.El(t);case 5:return t.stringValue;case 6:return new Lc(Io(t.bytesValue));case 7:return this.Il(t.referenceValue);case 8:return this.Rl(t.geoPointValue);case 9:return this.Al(t.arrayValue);case 10:return this.Pl(t.mapValue);default:throw Pi()}},rf.prototype.Pl=function(t){var n=this,i={};return Gi(t.fields||{},function(t,e){i[t]=n.ml(e)}),i},rf.prototype.Rl=function(t){return new Zc(Eo(t.latitude),Eo(t.longitude))},rf.prototype.Al=function(t){var e=this;return(t.values||[]).map(function(t){return e.ml(t)})},rf.prototype.El=function(t){switch(this.dl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return co(n)?t(n):n}(t);return null==e?null:this.ml(e);case"estimate":return this.Tl(lo(t));default:return null}},rf.prototype.Tl=function(t){var e=bo(t),n=new Ki(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},rf.prototype.Il=function(t){var e=tr.$(t);Vi(Ho(e));var n=new ji(e.get(1),e.get(3)),i=new ir(e.p(5));return n.isEqual(this.s)||Oi("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.wl(i)},rf),jl=da.ni,Fl=(nf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},nf),Bl=(Object.defineProperty(ef.prototype,"Nl",{get:function(){return this.$l||(this.$l=new yl(this.Nc,this.Fl.ignoreUndefinedProperties)),this.$l},enumerable:!1,configurable:!0}),ef.prototype.settings=function(t){hc("Firestore.settings",arguments,1),fc("Firestore.settings","object",1,t);var e=new Fl(t);if(this.bl&&!this.Fl.isEqual(e))throw new Yi(Xi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Fl=e).credentials&&(this.Dl=function(t){if(!t)return new Wa;switch(t.type){case"gapi":var e=t.kl;return Vi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xa(e,t.Ir||"0");case"provider":return t.kl;default:throw new Yi(Xi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},ef.prototype.enableNetwork=function(){return this.vl(),this.bl.enableNetwork()},ef.prototype.disableNetwork=function(){return this.vl(),this.bl.disableNetwork()},ef.prototype.enablePersistence=function(t){var e,n;if(this.bl)throw new Yi(Xi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Oi("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Yi(Xi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ol(this.Vl,this.yl,{lc:!0,cacheSizeBytes:this.Fl.cacheSizeBytes,synchronizeTabs:i,xl:r})},ef.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.bl&&!this.bl.fl)throw new Yi(Xi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ra,[2,(this.gl.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Vl.clearPersistence(this.Nc,this.Cl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},ef.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(ef.prototype,"Ll",{get:function(){return this.vl(),this.bl.fl},enumerable:!1,configurable:!0}),ef.prototype.waitForPendingWrites=function(){return this.vl(),this.bl.waitForPendingWrites()},ef.prototype.onSnapshotsInSync=function(t){if(this.vl(),oc(t))return this.bl.Fa(t);fc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.bl.Fa(e)},ef.prototype.vl=function(){return this.bl||this.Ol(new ec,new nc,{lc:!1}),this.bl},ef.prototype.Ml=function(){return new xi(this.Nc,this.Cl,this.Fl.host,this.Fl.ssl,this.Fl.forceLongPolling)},ef.prototype.Ol=function(t,e,n){var i=this.Ml();return this.bl=new Dl(this.Dl,this.gl),this.bl.start(i,t,e,n)},ef.Sl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yi(Xi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yi(Xi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ji(n)},Object.defineProperty(ef.prototype,"app",{get:function(){if(!this.pl)throw new Yi(Xi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pl},enumerable:!1,configurable:!0}),ef.prototype.collection=function(t){return hc("Firestore.collection",arguments,1),fc("Firestore.collection","non-empty string",1,t),this.vl(),new ff(tr.$(t),this,null)},ef.prototype.doc=function(t){return hc("Firestore.doc",arguments,1),fc("Firestore.doc","non-empty string",1,t),this.vl(),$l.ql(tr.$(t),this,null)},ef.prototype.collectionGroup=function(t){if(hc("Firestore.collectionGroup",arguments,1),fc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.vl(),new cf((e=t,new nu(tr.k(),e)),this,null);var e},ef.prototype.runTransaction=function(e){var n=this;return hc("Firestore.runTransaction",arguments,1),fc("Firestore.runTransaction","function",1,e),this.vl().transaction(function(t){return e(new Gl(n,t))})},ef.prototype.batch=function(){return this.vl(),new zl(this)},Object.defineProperty(ef,"logLevel",{get:function(){switch(Si()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),ef.setLogLevel=function(t){hc("Firestore.setLogLevel",arguments,1),gc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),ki.setLogLevel(t)},ef.prototype.Ul=function(){return this.Fl.timestampsInSnapshots},ef),Gl=(tf.prototype.get=function(t){var n=this;hc("Transaction.get",arguments,1);var i=wf("Transaction.get",t,this.Bl);return this.Wl.Hc([i.$c]).then(function(t){if(!t||1!==t.length)return Pi();var e=t[0];if(e instanceof Ys)return new Hl(n.Bl,i.$c,null,!1,!1,i.kc);if(e instanceof Xs)return new Hl(n.Bl,i.$c,e,!1,!1,i.kc);throw Pi()})},tf.prototype.set=function(t,e,n){lc("Transaction.set",arguments,2,3);var i=wf("Transaction.set",t,this.Bl);n=vf("Transaction.set",n);var r=bf(i.kc,e,n),o=ml(this.Bl.Nl,"Transaction.set",i.$c,r,null!==i.kc,n);return this.Wl.set(i.$c,o),this},tf.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Pc?(cc("Transaction.update",arguments,3),i=wf("Transaction.update",t,this.Bl),bl(this.Bl.Nl,"Transaction.update",i.$c,e,n,o)):(hc("Transaction.update",arguments,2),i=wf("Transaction.update",t,this.Bl),wl(this.Bl.Nl,"Transaction.update",i.$c,e)),this.Wl.update(i.$c,r),this},tf.prototype.delete=function(t){hc("Transaction.delete",arguments,1);var e=wf("Transaction.delete",t,this.Bl);return this.Wl.delete(e.$c),this},tf),zl=(Zl.prototype.set=function(t,e,n){lc("WriteBatch.set",arguments,2,3),this.Gl();var i=wf("WriteBatch.set",t,this.Bl);n=vf("WriteBatch.set",n);var r=bf(i.kc,e,n),o=ml(this.Bl.Nl,"WriteBatch.set",i.$c,r,null!==i.kc,n);return this.Ql=this.Ql.concat(o.Oc(i.$c,vs.Ge())),this},Zl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Gl(),r="string"==typeof e||e instanceof Pc?(cc("WriteBatch.update",arguments,3),i=wf("WriteBatch.update",t,this.Bl),bl(this.Bl.Nl,"WriteBatch.update",i.$c,e,n,o)):(hc("WriteBatch.update",arguments,2),i=wf("WriteBatch.update",t,this.Bl),wl(this.Bl.Nl,"WriteBatch.update",i.$c,e)),this.Ql=this.Ql.concat(r.Oc(i.$c,vs.exists(!0))),this},Zl.prototype.delete=function(t){hc("WriteBatch.delete",arguments,1),this.Gl();var e=wf("WriteBatch.delete",t,this.Bl);return this.Ql=this.Ql.concat(new Ms(e.$c,vs.Ge())),this},Zl.prototype.commit=function(){return this.Gl(),this.jl=!0,0<this.Ql.length?this.Bl.vl().write(this.Ql):Promise.resolve()},Zl.prototype.Gl=function(){if(this.jl)throw new Yi(Xi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Zl),$l=(n(Jl,ql=el),Jl.ql=function(t,e,n){if(t.length%2!=0)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Jl(new ir(t),e,n)},Object.defineProperty(Jl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"parent",{get:function(){return new ff(this.$c.path.g(),this.firestore,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"path",{get:function(){return this.$c.path.N()},enumerable:!1,configurable:!0}),Jl.prototype.collection=function(t){if(hc("DocumentReference.collection",arguments,1),fc("DocumentReference.collection","non-empty string",1,t),!t)throw new Yi(Xi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=tr.$(t);return new ff(this.$c.path.child(e),this.firestore,null)},Jl.prototype.isEqual=function(t){if(!(t instanceof Jl))throw Ac("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$c.isEqual(t.$c)&&this.kc===t.kc},Jl.prototype.set=function(t,e){lc("DocumentReference.set",arguments,1,2),e=vf("DocumentReference.set",e);var n=bf(this.kc,t,e),i=ml(this.firestore.Nl,"DocumentReference.set",this.$c,n,null!==this.kc,e);return this.bl.write(i.Oc(this.$c,vs.Ge()))},Jl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Pc?(cc("DocumentReference.update",arguments,2),bl(this.firestore.Nl,"DocumentReference.update",this.$c,t,e,i)):(hc("DocumentReference.update",arguments,1),wl(this.firestore.Nl,"DocumentReference.update",this.$c,t)),this.bl.write(n.Oc(this.$c,vs.exists(!0)))},Jl.prototype.delete=function(){return hc("DocumentReference.delete",arguments,0),this.bl.write([new Ms(this.$c,vs.Ge())])},Jl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];lc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof r[u]||oc(r[u])||(Ic("DocumentReference.onSnapshot",s=r[u],["includeMetadataChanges"]),yc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};oc(r[u])?(a=r[u],r[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),r[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),r[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(fc("DocumentReference.onSnapshot","function",u,r[u]),pc("DocumentReference.onSnapshot","function",u+1,r[u+1]),pc("DocumentReference.onSnapshot","function",u+2,r[u+2]));var c={next:function(t){r[u]&&r[u](i.Kl(t))},error:r[u+1],complete:r[u+2]};return this.bl.listen(ru(this.$c.path),h,c)},Jl.prototype.get=function(t){var e=this;lc("DocumentReference.get",arguments,0,1),mf("DocumentReference.get",t);var n=this.firestore.vl();return t&&"cache"===t.source?n.ul(this.$c).then(function(t){return new Hl(e.firestore,e.$c,t,!0,t instanceof Xs&&t.Ke,e.kc)}):n.cl(this.$c,t).then(function(t){return e.Kl(t)})},Jl.prototype.withConverter=function(t){return new Jl(this.$c,this.firestore,t)},Jl.prototype.Kl=function(t){var e=t.docs.get(this.$c);return new Hl(this.firestore,this.$c,e,t.fromCache,t.hasPendingWrites,this.kc)},Jl),Wl=(Kl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Kl),Hl=(Yl.prototype.data=function(t){var e=this;if(lc("DocumentSnapshot.data",arguments,0,1),t=gf("DocumentSnapshot.data",t),this.zl){if(this.kc){var n=new Ql(this.Bl,this.$c,this.zl,this.Hl,this.Yl,null);return this.kc.fromFirestore(n,t)}return new xl(this.Bl.Nc,this.Bl.Ul(),t.serverTimestamps||"none",function(t){return new $l(t,e.Bl,null)}).ml(this.zl.tn())}},Yl.prototype.get=function(t,e){var n=this;if(lc("DocumentSnapshot.get",arguments,1,2),e=gf("DocumentSnapshot.get",e),this.zl){var i=this.zl.data().field(Rl("DocumentSnapshot.get",t,this.$c));if(null!==i)return new xl(this.Bl.Nc,this.Bl.Ul(),e.serverTimestamps||"none",function(t){return new $l(t,n.Bl,n.kc)}).ml(i)}},Object.defineProperty(Yl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"ref",{get:function(){return new $l(this.$c,this.Bl,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"exists",{get:function(){return null!==this.zl},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"metadata",{get:function(){return new Wl(this.Yl,this.Hl)},enumerable:!1,configurable:!0}),Yl.prototype.isEqual=function(t){if(!(t instanceof Yl))throw Ac("isEqual","DocumentSnapshot",1,t);return this.Bl===t.Bl&&this.Hl===t.Hl&&this.$c.isEqual(t.$c)&&(null===this.zl?null===t.zl:this.zl.isEqual(t.zl))&&this.kc===t.kc},Yl),Ql=(n(Xl,Ml=Hl),Xl.prototype.data=function(t){return Ml.prototype.data.call(this,t)},Xl);function Xl(){return null!==Ml&&Ml.apply(this,arguments)||this}function Yl(t,e,n,i,r,o){this.Bl=t,this.$c=e,this.zl=n,this.Hl=i,this.Yl=r,this.kc=o}function Kl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Jl(t,e,n){var i=this;return(i=ql.call(this,e.Nc,t,n)||this).$c=t,i.firestore=e,i.kc=n,i.bl=i.firestore.vl(),i}function Zl(t){this.Bl=t,this.Ql=[],this.jl=!1}function tf(t,e){this.Bl=t,this.Wl=e}function ef(t,e,n,i){var r=this;if(void 0===n&&(n=new ec),void 0===i&&(i=new nc),this.Vl=n,this.yl=i,this.pl=null,this.gl=new ca,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.vl(),[4,this.bl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.pl=o,this.Nc=ef.Sl(o),this.Cl=o.name,this.Dl=new Ha(e)}else{var s=t;if(!s.projectId)throw new Yi(Xi.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new ji(s.projectId,s.database),this.Cl="[DEFAULT]",this.Dl=new Wa}this.Fl=new Fl({})}function nf(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Yi(Xi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else dc("settings","non-empty string","host",t.host),this.host=t.host,yc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ic("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),yc("settings","object","credentials",t.credentials),this.credentials=t.credentials,yc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),yc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Oi("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Oi("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,yc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=da.ii;else{if(t.cacheSizeBytes!==jl&&t.cacheSizeBytes<da.si)throw new Yi(Xi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+da.si);this.cacheSizeBytes=t.cacheSizeBytes}yc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function rf(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.dl=n,this.wl=i}function of(t,e,n){if("string"==typeof n){if(""===n)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ou(e)&&-1!==n.indexOf("/"))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(tr.$(n));if(!ir.j(i))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return Ao(t,new ir(i))}if(n instanceof el)return Ao(t,n.$c);throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+bc(n)+".")}function sf(t,e){if(!Array.isArray(t)||0===t.length)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function uf(t,e,n){if(!n.isEqual(e))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function af(t){if(t.un()&&0===t.en.length)throw new Yi(Xi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var hf,cf=(yf.prototype.where=function(t,e,n){var i;hc("Query.where",arguments,3),Ec("Query.where",3,n),i="not-in"===e||"!="===e?e:gc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=Rl("Query.where",t),u=function(t,e,n,i,r,o,s){var u;if(r.L()){if("array-contains"===o||"array-contains-any"===o)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){sf(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var l=c[h];a.push(of(i,t,l))}u={arrayValue:{values:a}}}else u=of(i,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||sf(s,o),u=El(n,e,s,"in"===o||"not-in"===o);var f=gu.create(r,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.cn();null!==i&&uf(0,e.field,i)}var r=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,f),f}(this.Jl,"Query.where",this.firestore.Nl,this.firestore.Nc,s,i,n);return new yf((r=this.Jl,o=r.filters.concat([u]),new nu(r.path,r.collectionGroup,r.en.slice(),o,r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.kc)},yf.prototype.orderBy=function(t,e){var n;if(lc("Query.orderBy",arguments,1,2),pc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yi(Xi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=Rl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o,s=new $u(e,n);return r=s,null!==(i=t).cn()||null!==(o=i.ln())&&uf(0,o,r.field),s}(this.Jl,o,n);return new yf((i=this.Jl,r=i.en.concat([s]),new nu(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.kc)},yf.prototype.limit=function(t){return hc("Query.limit",arguments,1),fc("Query.limit","number",1,t),Tc("Query.limit",1,t),new yf(au(this.Jl,t,"F"),this.firestore,this.kc)},yf.prototype.limitToLast=function(t){return hc("Query.limitToLast",arguments,1),fc("Query.limitToLast","number",1,t),Tc("Query.limitToLast",1,t),new yf(au(this.Jl,t,"L"),this.firestore,this.kc)},yf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];cc("Query.startAt",arguments,1);var i=this.Xl("Query.startAt",t,e,!0);return new yf(hu(this.Jl,i),this.firestore,this.kc)},yf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];cc("Query.startAfter",arguments,1);var i=this.Xl("Query.startAfter",t,e,!1);return new yf(hu(this.Jl,i),this.firestore,this.kc)},yf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];cc("Query.endBefore",arguments,1);var i=this.Xl("Query.endBefore",t,e,!0);return new yf(cu(this.Jl,i),this.firestore,this.kc)},yf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];cc("Query.endAt",arguments,1);var i=this.Xl("Query.endAt",t,e,!1);return new yf(cu(this.Jl,i),this.firestore,this.kc)},yf.prototype.isEqual=function(t){if(!(t instanceof yf))throw Ac("isEqual","Query",1,t);return this.firestore===t.firestore&&lu(this.Jl,t.Jl)&&this.kc===t.kc},yf.prototype.withConverter=function(t){return new yf(this.Jl,this.firestore,t)},yf.prototype.Xl=function(c,t,e,n){if(Ec(c,1,t),t instanceof Hl)return hc(c,r([t],e),1),function(t,e,n,i){if(!n)throw new Yi(Xi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=su(t);o<s.length;o++){var u=s[o];if(u.field.L())r.push(Ao(e,n.key));else{var a=n.field(u.field);if(co(a))throw new Yi(Xi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Mu(r,i)}(this.Jl,this.firestore.Nc,t.zl,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.en;if(r.length>s.length)throw new Yi(Xi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<r.length;a++){var h=r[a];if(s[a].field.L()){if("string"!=typeof h)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!ou(t)&&-1!==h.indexOf("/"))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(tr.$(h));if(!ir.j(c))throw new Yi(Xi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ir(c);u.push(Ao(e,l))}else{var f=El(n,i,h);u.push(f)}}return new Mu(u,o)}(this.Jl,this.firestore.Nc,this.firestore.Nl,c,i,n)},yf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];lc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof r[a]||oc(r[a])||(Ic("Query.onSnapshot",u=r[a],["includeMetadataChanges"]),yc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),oc(r[a])?(s=r[a],r[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(fc("Query.onSnapshot","function",a,r[a]),pc("Query.onSnapshot","function",a+1,r[a+1]),pc("Query.onSnapshot","function",a+2,r[a+2]));var h={next:function(t){r[a]&&r[a](new lf(i.firestore,i.Jl,t,i.kc))},error:r[a+1],complete:r[a+2]};return af(this.Jl),this.firestore.vl().listen(this.Jl,u,h)},yf.prototype.get=function(t){var e=this;lc("Query.get",arguments,0,1),mf("Query.get",t),af(this.Jl);var n=this.firestore.vl();return(t&&"cache"===t.source?n.ll(this.Jl):n._l(this.Jl,t)).then(function(t){return new lf(e.firestore,e.Jl,t,e.kc)})},yf),lf=(Object.defineProperty(df.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(df.prototype,"empty",{get:function(){return this.t_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(df.prototype,"size",{get:function(){return this.t_.docs.size},enumerable:!1,configurable:!0}),df.prototype.forEach=function(e,n){var i=this;lc("QuerySnapshot.forEach",arguments,1,2),fc("QuerySnapshot.forEach","function",1,e),this.t_.docs.forEach(function(t){e.call(n,i.s_(t,i.metadata.fromCache,i.t_.qt.has(t.key)))})},Object.defineProperty(df.prototype,"query",{get:function(){return new cf(this.Zl,this.Bl,this.kc)},enumerable:!1,configurable:!0}),df.prototype.docChanges=function(t){t&&(Ic("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),yc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.t_.Bt)throw new Yi(Xi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.e_&&this.n_===e||(this.e_=function(r,e,o){if(r.Mt._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Mt;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pi()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.t_,e,this.s_.bind(this)),this.n_=e),this.e_},df.prototype.isEqual=function(t){if(!(t instanceof df))throw Ac("isEqual","QuerySnapshot",1,t);return this.Bl===t.Bl&&lu(this.Zl,t.Zl)&&this.t_.isEqual(t.t_)&&this.kc===t.kc},df.prototype.s_=function(t,e,n){return new Ql(this.Bl,t.key,t,e,n,this.kc)},df),ff=(n(pf,hf=cf),Object.defineProperty(pf.prototype,"id",{get:function(){return this.Jl.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"parent",{get:function(){var t=this.Jl.path.g();return t._()?null:new $l(new ir(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"path",{get:function(){return this.Jl.path.N()},enumerable:!1,configurable:!0}),pf.prototype.doc=function(t){lc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ci.t()),fc("CollectionReference.doc","non-empty string",1,t);var e=tr.$(t);return $l.ql(this.Jl.path.child(e),this.firestore,this.kc)},pf.prototype.add=function(t){hc("CollectionReference.add",arguments,1),fc("CollectionReference.add","object",1,this.kc?this.kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},pf.prototype.withConverter=function(t){return new pf(this.i_,this.firestore,t)},pf);function pf(t,e,n){var i=this;if(((i=hf.call(this,ru(t),e,n)||this).i_=t).length%2!=1)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function df(t,e,n,i){this.Bl=t,this.Zl=e,this.t_=n,this.kc=i,this.e_=null,this.n_=null,this.metadata=new Wl(n.hasPendingWrites,n.fromCache)}function yf(t,e,n){this.Jl=t,this.firestore=e,this.kc=n}function vf(t,e){if(void 0===e)return{merge:!1};if(Ic(t,e,["merge","mergeFields"]),yc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+bc(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Yi(Xi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+bc(n[r]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Pc}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yi(Xi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function gf(t,e){return void 0===e?{}:(Ic(t,e,["serverTimestamps"]),vc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function mf(t,e){pc(t,"object",1,e),e&&(Ic(t,e,["source"]),vc(t,0,"source",e.source,["default","server","cache"]))}function wf(t,e,n){if(e instanceof el){if(e.firestore!==n)throw new Yi(Xi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ac(t,"DocumentReference",1,e)}function bf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ef,If={Firestore:Bl,GeoPoint:Zc,Timestamp:Ki,Blob:Lc,Transaction:Gl,WriteBatch:zl,DocumentReference:$l,DocumentSnapshot:Hl,Query:cf,QueryDocumentSnapshot:Ql,QuerySnapshot:lf,CollectionReference:ff,FieldPath:Pc,FieldValue:Kc,setLogLevel:Bl.setLogLevel,CACHE_SIZE_UNLIMITED:jl};(Ef=Af).INTERNAL.registerComponent(new Ni("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Bl(e,n,new ec,new nc);var e,n},"PUBLIC").setServiceProps(Object.assign({},If))),Ef.registerVersion("@firebase/firestore","1.16.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
